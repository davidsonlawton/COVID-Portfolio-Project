{
 "cells": [
  {
   "cell_type": "code",
   "execution_count": 1,
   "id": "532d29d2",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>poster</th>\n",
       "      <th>title</th>\n",
       "      <th>certificate</th>\n",
       "      <th>runtime</th>\n",
       "      <th>genre</th>\n",
       "      <th>rating</th>\n",
       "      <th>about</th>\n",
       "      <th>director</th>\n",
       "      <th>stars</th>\n",
       "      <th>votes</th>\n",
       "      <th>gross_earn</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>https://m.media-amazon.com/images/S/sash/4Fyxw...</td>\n",
       "      <td>The Shawshank Redemption</td>\n",
       "      <td>15</td>\n",
       "      <td>142 min</td>\n",
       "      <td>Drama</td>\n",
       "      <td>9.3</td>\n",
       "      <td>Two imprisoned men bond over a number of years...</td>\n",
       "      <td>Frank Darabont</td>\n",
       "      <td>('Tim Robbins',), ('Morgan Freeman',), ('Bob G...</td>\n",
       "      <td>26,26,905</td>\n",
       "      <td>$28.34M</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>https://m.media-amazon.com/images/S/sash/4Fyxw...</td>\n",
       "      <td>The Dark Knight</td>\n",
       "      <td>12A</td>\n",
       "      <td>152 min</td>\n",
       "      <td>Action, Crime, Drama</td>\n",
       "      <td>9.0</td>\n",
       "      <td>When the menace known as the Joker wreaks havo...</td>\n",
       "      <td>Christopher Nolan</td>\n",
       "      <td>('Christian Bale',), ('Heath Ledger',), ('Aaro...</td>\n",
       "      <td>25,98,173</td>\n",
       "      <td>$534.86M</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>https://m.media-amazon.com/images/S/sash/4Fyxw...</td>\n",
       "      <td>Inception</td>\n",
       "      <td>12A</td>\n",
       "      <td>148 min</td>\n",
       "      <td>Action, Adventure, Sci-Fi</td>\n",
       "      <td>8.8</td>\n",
       "      <td>A thief who steals corporate secrets through t...</td>\n",
       "      <td>Christopher Nolan</td>\n",
       "      <td>('Leonardo DiCaprio',), ('Joseph Gordon-Levitt...</td>\n",
       "      <td>23,04,062</td>\n",
       "      <td>$292.58M</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>https://m.media-amazon.com/images/S/sash/4Fyxw...</td>\n",
       "      <td>Fight Club</td>\n",
       "      <td>18</td>\n",
       "      <td>139 min</td>\n",
       "      <td>Drama</td>\n",
       "      <td>8.8</td>\n",
       "      <td>An insomniac office worker and a devil-may-car...</td>\n",
       "      <td>David Fincher</td>\n",
       "      <td>('Brad Pitt',), ('Edward Norton',), ('Meat Loa...</td>\n",
       "      <td>20,71,088</td>\n",
       "      <td>$37.03M</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>https://m.media-amazon.com/images/S/sash/4Fyxw...</td>\n",
       "      <td>Pulp Fiction</td>\n",
       "      <td>18</td>\n",
       "      <td>154 min</td>\n",
       "      <td>Crime, Drama</td>\n",
       "      <td>8.9</td>\n",
       "      <td>The lives of two mob hitmen, a boxer, a gangst...</td>\n",
       "      <td>Quentin Tarantino</td>\n",
       "      <td>('John Travolta',), ('Uma Thurman',), ('Samuel...</td>\n",
       "      <td>20,11,013</td>\n",
       "      <td>$107.93M</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "                                              poster  \\\n",
       "0  https://m.media-amazon.com/images/S/sash/4Fyxw...   \n",
       "1  https://m.media-amazon.com/images/S/sash/4Fyxw...   \n",
       "2  https://m.media-amazon.com/images/S/sash/4Fyxw...   \n",
       "3  https://m.media-amazon.com/images/S/sash/4Fyxw...   \n",
       "4  https://m.media-amazon.com/images/S/sash/4Fyxw...   \n",
       "\n",
       "                      title certificate  runtime                      genre  \\\n",
       "0  The Shawshank Redemption          15  142 min                      Drama   \n",
       "1           The Dark Knight         12A  152 min       Action, Crime, Drama   \n",
       "2                 Inception         12A  148 min  Action, Adventure, Sci-Fi   \n",
       "3                Fight Club          18  139 min                      Drama   \n",
       "4              Pulp Fiction          18  154 min               Crime, Drama   \n",
       "\n",
       "   rating                                              about  \\\n",
       "0     9.3  Two imprisoned men bond over a number of years...   \n",
       "1     9.0  When the menace known as the Joker wreaks havo...   \n",
       "2     8.8  A thief who steals corporate secrets through t...   \n",
       "3     8.8  An insomniac office worker and a devil-may-car...   \n",
       "4     8.9  The lives of two mob hitmen, a boxer, a gangst...   \n",
       "\n",
       "            director                                              stars  \\\n",
       "0     Frank Darabont  ('Tim Robbins',), ('Morgan Freeman',), ('Bob G...   \n",
       "1  Christopher Nolan  ('Christian Bale',), ('Heath Ledger',), ('Aaro...   \n",
       "2  Christopher Nolan  ('Leonardo DiCaprio',), ('Joseph Gordon-Levitt...   \n",
       "3      David Fincher  ('Brad Pitt',), ('Edward Norton',), ('Meat Loa...   \n",
       "4  Quentin Tarantino  ('John Travolta',), ('Uma Thurman',), ('Samuel...   \n",
       "\n",
       "       votes gross_earn  \n",
       "0  26,26,905    $28.34M  \n",
       "1  25,98,173   $534.86M  \n",
       "2  23,04,062   $292.58M  \n",
       "3  20,71,088    $37.03M  \n",
       "4  20,11,013   $107.93M  "
      ]
     },
     "execution_count": 1,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "import pandas as pd\n",
    "from sklearn.cluster import KMeans\n",
    "from sklearn.preprocessing import StandardScaler\n",
    "import re\n",
    "\n",
    "# Load the dataset \n",
    "movies1 = pd.read_csv('movies.csv')\n",
    "movies = movies1[['title', 'genre', 'rating', 'runtime', 'votes', 'director', 'gross_earn']]\n",
    "movies1.head()\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "id": "e4b6e992",
   "metadata": {},
   "outputs": [],
   "source": [
    "import numpy as np\n",
    "import matplotlib.pyplot as plt"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "id": "91ed8f73",
   "metadata": {},
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "/var/folders/qh/81164_ks5gn9fq0dc70qm_fh0000gn/T/ipykernel_59329/788055161.py:10: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  movies['runtime'][i] = runtime\n",
      "/var/folders/qh/81164_ks5gn9fq0dc70qm_fh0000gn/T/ipykernel_59329/788055161.py:18: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  movies['runtime'][i] = int(mean_runtime)\n"
     ]
    }
   ],
   "source": [
    "# runtime is formatted using avrage as a replacement for a null\n",
    "total_runtime = 0\n",
    "num_movies = 0\n",
    "#predict gross earnings \n",
    "#director evpetice 10 movies > director\n",
    "#certificae {looks at housing example in canelink bte}\n",
    "for i in range(len(movies['runtime'])):\n",
    "    try:\n",
    "        runtime = int(movies['runtime'][i].replace(' min', ''))\n",
    "        movies['runtime'][i] = runtime\n",
    "        total_runtime += runtime\n",
    "        num_movies += 1\n",
    "    except ValueError:\n",
    "        if num_movies == 0:\n",
    "            movies['runtime'][i] = -1\n",
    "        else:\n",
    "            mean_runtime = total_runtime / num_movies\n",
    "            movies['runtime'][i] = int(mean_runtime)\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "7eb416e0",
   "metadata": {},
   "outputs": [],
   "source": []
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "id": "c8a90f71",
   "metadata": {
    "scrolled": false
   },
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "/var/folders/qh/81164_ks5gn9fq0dc70qm_fh0000gn/T/ipykernel_59329/399998552.py:2: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  movies['genres_list'] = movies['genre'].str.split(', ')\n",
      "/var/folders/qh/81164_ks5gn9fq0dc70qm_fh0000gn/T/ipykernel_59329/399998552.py:3: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  movies['genres_list'] = movies['genres_list'].apply(lambda x: sorted(x) if isinstance(x, list) else [])\n",
      "/var/folders/qh/81164_ks5gn9fq0dc70qm_fh0000gn/T/ipykernel_59329/399998552.py:4: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  movies['genres_list'] = movies['genres_list'].apply(lambda x: x if x else ['Unknown'])\n"
     ]
    }
   ],
   "source": [
    "# formatt for genre\n",
    "movies['genres_list'] = movies['genre'].str.split(', ')\n",
    "movies['genres_list'] = movies['genres_list'].apply(lambda x: sorted(x) if isinstance(x, list) else [])\n",
    "movies['genres_list'] = movies['genres_list'].apply(lambda x: x if x else ['Unknown'])\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "id": "5ade9003",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>title</th>\n",
       "      <th>genre</th>\n",
       "      <th>rating</th>\n",
       "      <th>runtime</th>\n",
       "      <th>votes</th>\n",
       "      <th>director</th>\n",
       "      <th>gross_earn</th>\n",
       "      <th>genres_list</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>The Shawshank Redemption</td>\n",
       "      <td>Drama</td>\n",
       "      <td>9.3</td>\n",
       "      <td>142</td>\n",
       "      <td>26,26,905</td>\n",
       "      <td>Frank Darabont</td>\n",
       "      <td>$28.34M</td>\n",
       "      <td>[Drama]</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>The Dark Knight</td>\n",
       "      <td>Action, Crime, Drama</td>\n",
       "      <td>9.0</td>\n",
       "      <td>152</td>\n",
       "      <td>25,98,173</td>\n",
       "      <td>Christopher Nolan</td>\n",
       "      <td>$534.86M</td>\n",
       "      <td>[Action, Crime, Drama]</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>Inception</td>\n",
       "      <td>Action, Adventure, Sci-Fi</td>\n",
       "      <td>8.8</td>\n",
       "      <td>148</td>\n",
       "      <td>23,04,062</td>\n",
       "      <td>Christopher Nolan</td>\n",
       "      <td>$292.58M</td>\n",
       "      <td>[Action, Adventure, Sci-Fi]</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>Fight Club</td>\n",
       "      <td>Drama</td>\n",
       "      <td>8.8</td>\n",
       "      <td>139</td>\n",
       "      <td>20,71,088</td>\n",
       "      <td>David Fincher</td>\n",
       "      <td>$37.03M</td>\n",
       "      <td>[Drama]</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>Pulp Fiction</td>\n",
       "      <td>Crime, Drama</td>\n",
       "      <td>8.9</td>\n",
       "      <td>154</td>\n",
       "      <td>20,11,013</td>\n",
       "      <td>Quentin Tarantino</td>\n",
       "      <td>$107.93M</td>\n",
       "      <td>[Crime, Drama]</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>95</th>\n",
       "      <td>District 9</td>\n",
       "      <td>Action, Sci-Fi, Thriller</td>\n",
       "      <td>7.9</td>\n",
       "      <td>112</td>\n",
       "      <td>6,76,036</td>\n",
       "      <td>Neill Blomkamp</td>\n",
       "      <td>$115.65M</td>\n",
       "      <td>[Action, Sci-Fi, Thriller]</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>96</th>\n",
       "      <td>I Am Legend</td>\n",
       "      <td>Action, Drama, Sci-Fi</td>\n",
       "      <td>7.2</td>\n",
       "      <td>101</td>\n",
       "      <td>7,47,517</td>\n",
       "      <td>Francis Lawrence</td>\n",
       "      <td>$256.39M</td>\n",
       "      <td>[Action, Drama, Sci-Fi]</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>97</th>\n",
       "      <td>Catch Me If You Can</td>\n",
       "      <td>Biography, Crime, Drama</td>\n",
       "      <td>8.1</td>\n",
       "      <td>141</td>\n",
       "      <td>9,58,178</td>\n",
       "      <td>Steven Spielberg</td>\n",
       "      <td>$164.62M</td>\n",
       "      <td>[Biography, Crime, Drama]</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>98</th>\n",
       "      <td>Skyfall</td>\n",
       "      <td>Action, Adventure, Thriller</td>\n",
       "      <td>7.8</td>\n",
       "      <td>143</td>\n",
       "      <td>6,91,070</td>\n",
       "      <td>Sam Mendes</td>\n",
       "      <td>$304.36M</td>\n",
       "      <td>[Action, Adventure, Thriller]</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>99</th>\n",
       "      <td>Pirates of the Caribbean: Dead Man's Chest</td>\n",
       "      <td>Action, Adventure, Fantasy</td>\n",
       "      <td>7.3</td>\n",
       "      <td>151</td>\n",
       "      <td>7,10,348</td>\n",
       "      <td>Gore Verbinski</td>\n",
       "      <td>$423.32M</td>\n",
       "      <td>[Action, Adventure, Fantasy]</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>100 rows × 8 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "                                         title                        genre  \\\n",
       "0                     The Shawshank Redemption                        Drama   \n",
       "1                              The Dark Knight         Action, Crime, Drama   \n",
       "2                                    Inception    Action, Adventure, Sci-Fi   \n",
       "3                                   Fight Club                        Drama   \n",
       "4                                 Pulp Fiction                 Crime, Drama   \n",
       "..                                         ...                          ...   \n",
       "95                                  District 9     Action, Sci-Fi, Thriller   \n",
       "96                                 I Am Legend        Action, Drama, Sci-Fi   \n",
       "97                         Catch Me If You Can      Biography, Crime, Drama   \n",
       "98                                     Skyfall  Action, Adventure, Thriller   \n",
       "99  Pirates of the Caribbean: Dead Man's Chest   Action, Adventure, Fantasy   \n",
       "\n",
       "    rating runtime      votes           director gross_earn  \\\n",
       "0      9.3     142  26,26,905     Frank Darabont    $28.34M   \n",
       "1      9.0     152  25,98,173  Christopher Nolan   $534.86M   \n",
       "2      8.8     148  23,04,062  Christopher Nolan   $292.58M   \n",
       "3      8.8     139  20,71,088      David Fincher    $37.03M   \n",
       "4      8.9     154  20,11,013  Quentin Tarantino   $107.93M   \n",
       "..     ...     ...        ...                ...        ...   \n",
       "95     7.9     112   6,76,036     Neill Blomkamp   $115.65M   \n",
       "96     7.2     101   7,47,517   Francis Lawrence   $256.39M   \n",
       "97     8.1     141   9,58,178   Steven Spielberg   $164.62M   \n",
       "98     7.8     143   6,91,070         Sam Mendes   $304.36M   \n",
       "99     7.3     151   7,10,348     Gore Verbinski   $423.32M   \n",
       "\n",
       "                      genres_list  \n",
       "0                         [Drama]  \n",
       "1          [Action, Crime, Drama]  \n",
       "2     [Action, Adventure, Sci-Fi]  \n",
       "3                         [Drama]  \n",
       "4                  [Crime, Drama]  \n",
       "..                            ...  \n",
       "95     [Action, Sci-Fi, Thriller]  \n",
       "96        [Action, Drama, Sci-Fi]  \n",
       "97      [Biography, Crime, Drama]  \n",
       "98  [Action, Adventure, Thriller]  \n",
       "99   [Action, Adventure, Fantasy]  \n",
       "\n",
       "[100 rows x 8 columns]"
      ]
     },
     "execution_count": 5,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "movies.head(100)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "84b94ee6",
   "metadata": {},
   "outputs": [],
   "source": []
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "id": "7edf6332",
   "metadata": {},
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "/var/folders/qh/81164_ks5gn9fq0dc70qm_fh0000gn/T/ipykernel_59329/313051277.py:2: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  movies['votes'] = movies['votes'].str.replace(',', '')\n",
      "/var/folders/qh/81164_ks5gn9fq0dc70qm_fh0000gn/T/ipykernel_59329/313051277.py:4: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  movies['votes'] = movies['votes'].str.replace(',', '').astype(float)\n"
     ]
    }
   ],
   "source": [
    "#cleaning votes to float\n",
    "movies['votes'] = movies['votes'].str.replace(',', '')\n",
    "#movies = movies.dropna(subset=['votes'])\n",
    "movies['votes'] = movies['votes'].str.replace(',', '').astype(float)\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "232dfd2c",
   "metadata": {},
   "outputs": [],
   "source": []
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "id": "ebdf502b",
   "metadata": {
    "scrolled": true
   },
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "/var/folders/qh/81164_ks5gn9fq0dc70qm_fh0000gn/T/ipykernel_59329/2381397896.py:2: FutureWarning: The default value of regex will change from True to False in a future version. In addition, single character regular expressions will *not* be treated as literal strings when regex=True.\n",
      "  movies['gross_earn'] = movies['gross_earn'].str.replace('$', '').str.replace('M', '').astype(float) * 1e6\n",
      "/var/folders/qh/81164_ks5gn9fq0dc70qm_fh0000gn/T/ipykernel_59329/2381397896.py:2: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  movies['gross_earn'] = movies['gross_earn'].str.replace('$', '').str.replace('M', '').astype(float) * 1e6\n"
     ]
    }
   ],
   "source": [
    "# formatting gross_earn\n",
    "movies['gross_earn'] = movies['gross_earn'].str.replace('$', '').str.replace('M', '').astype(float) * 1e6"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "id": "98f3181b",
   "metadata": {},
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "/var/folders/qh/81164_ks5gn9fq0dc70qm_fh0000gn/T/ipykernel_59329/1503337091.py:1: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  movies.dropna(subset=['gross_earn'], inplace=True)\n"
     ]
    }
   ],
   "source": [
    "movies.dropna(subset=['gross_earn'], inplace=True)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 9,
   "id": "26d690a9",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "     runtime      votes   gross_earn  rating\n",
      "0        142  2626905.0   28340000.0     9.3\n",
      "1        152  2598173.0  534860000.0     9.0\n",
      "2        148  2304062.0  292580000.0     8.8\n",
      "3        139  2071088.0   37030000.0     8.8\n",
      "4        154  2011013.0  107930000.0     8.9\n",
      "...      ...        ...          ...     ...\n",
      "4992      94    20309.0    6240000.0     6.2\n",
      "4993     117    25669.0   23000000.0     6.3\n",
      "4995     102    25112.0    9400000.0     7.3\n",
      "4998      92    21536.0    6670000.0     7.0\n",
      "4999     120    25097.0    8200000.0     7.6\n",
      "\n",
      "[4585 rows x 4 columns]\n"
     ]
    }
   ],
   "source": [
    "\n",
    "selected_columns = ['runtime', 'votes', 'gross_earn', 'rating']\n",
    "movies_subset = movies[selected_columns]\n",
    "\n",
    "print(movies_subset)\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 10,
   "id": "dd17ad53",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "15           1843\n",
       "12A           788\n",
       "18            659\n",
       "PG            614\n",
       "U             362\n",
       "12            278\n",
       "A             186\n",
       "X             134\n",
       "AA             59\n",
       "R              12\n",
       "UA             11\n",
       "PG-13          11\n",
       "Not Rated       7\n",
       "Rejected        5\n",
       "90 min          3\n",
       "106 min         2\n",
       "104 min         2\n",
       "99 min          2\n",
       "114 min         2\n",
       "70 min          1\n",
       "142 min         1\n",
       "103 min         1\n",
       "89 min          1\n",
       "112 min         1\n",
       "102 min         1\n",
       "98 min          1\n",
       "116 min         1\n",
       "119 min         1\n",
       "170 min         1\n",
       "140 min         1\n",
       "(Banned)        1\n",
       "87 min          1\n",
       "124 min         1\n",
       "107 min         1\n",
       "97 min          1\n",
       "93 min          1\n",
       "100 min         1\n",
       "137 min         1\n",
       "144 min         1\n",
       "Name: certificate, dtype: int64"
      ]
     },
     "execution_count": 10,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "movies1['certificate'].value_counts()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 11,
   "id": "38ad95f7",
   "metadata": {},
   "outputs": [],
   "source": [
    "valid_certificates = ['Film rated', '15', '12A', '18', 'PG', 'U', '12', 'A', 'X']\n",
    "movies1 = movies1[movies1['certificate'].isin(valid_certificates)]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 12,
   "id": "a1198479",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "(4864, 11)"
      ]
     },
     "execution_count": 12,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "movies1_na = movies1.dropna(subset = [\"certificate\"])\n",
    "movies1_na.shape"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "5953a30a",
   "metadata": {},
   "outputs": [],
   "source": []
  },
  {
   "cell_type": "code",
   "execution_count": 13,
   "id": "acd94cfd",
   "metadata": {
    "scrolled": true
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>title</th>\n",
       "      <th>runtime</th>\n",
       "      <th>genre</th>\n",
       "      <th>rating</th>\n",
       "      <th>director</th>\n",
       "      <th>votes</th>\n",
       "      <th>gross_earn</th>\n",
       "      <th>12</th>\n",
       "      <th>12A</th>\n",
       "      <th>15</th>\n",
       "      <th>18</th>\n",
       "      <th>A</th>\n",
       "      <th>PG</th>\n",
       "      <th>U</th>\n",
       "      <th>X</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>The Shawshank Redemption</td>\n",
       "      <td>142 min</td>\n",
       "      <td>Drama</td>\n",
       "      <td>9.3</td>\n",
       "      <td>Frank Darabont</td>\n",
       "      <td>26,26,905</td>\n",
       "      <td>$28.34M</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>The Dark Knight</td>\n",
       "      <td>152 min</td>\n",
       "      <td>Action, Crime, Drama</td>\n",
       "      <td>9.0</td>\n",
       "      <td>Christopher Nolan</td>\n",
       "      <td>25,98,173</td>\n",
       "      <td>$534.86M</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>Inception</td>\n",
       "      <td>148 min</td>\n",
       "      <td>Action, Adventure, Sci-Fi</td>\n",
       "      <td>8.8</td>\n",
       "      <td>Christopher Nolan</td>\n",
       "      <td>23,04,062</td>\n",
       "      <td>$292.58M</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>Fight Club</td>\n",
       "      <td>139 min</td>\n",
       "      <td>Drama</td>\n",
       "      <td>8.8</td>\n",
       "      <td>David Fincher</td>\n",
       "      <td>20,71,088</td>\n",
       "      <td>$37.03M</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>Pulp Fiction</td>\n",
       "      <td>154 min</td>\n",
       "      <td>Crime, Drama</td>\n",
       "      <td>8.9</td>\n",
       "      <td>Quentin Tarantino</td>\n",
       "      <td>20,11,013</td>\n",
       "      <td>$107.93M</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "                      title  runtime                      genre  rating  \\\n",
       "0  The Shawshank Redemption  142 min                      Drama     9.3   \n",
       "1           The Dark Knight  152 min       Action, Crime, Drama     9.0   \n",
       "2                 Inception  148 min  Action, Adventure, Sci-Fi     8.8   \n",
       "3                Fight Club  139 min                      Drama     8.8   \n",
       "4              Pulp Fiction  154 min               Crime, Drama     8.9   \n",
       "\n",
       "            director      votes gross_earn  12  12A  15  18  A  PG  U  X  \n",
       "0     Frank Darabont  26,26,905    $28.34M   0    0   1   0  0   0  0  0  \n",
       "1  Christopher Nolan  25,98,173   $534.86M   0    1   0   0  0   0  0  0  \n",
       "2  Christopher Nolan  23,04,062   $292.58M   0    1   0   0  0   0  0  0  \n",
       "3      David Fincher  20,71,088    $37.03M   0    0   0   1  0   0  0  0  \n",
       "4  Quentin Tarantino  20,11,013   $107.93M   0    0   0   1  0   0  0  0  "
      ]
     },
     "execution_count": 13,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "dummies = pd.get_dummies(movies1_na.certificate)\n",
    "dummies.head()\n",
    "movies1_na_dummies = pd.concat([movies1_na,dummies], axis = 'columns')\n",
    "movies1_na_dummies.head()\n",
    "movies1_clean = movies1_na_dummies.drop(['certificate','poster','about','stars'], axis = 'columns') #drop original column and observation column, the one with the lowest observations\n",
    "movies1_clean.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "f9eac757",
   "metadata": {},
   "outputs": [],
   "source": []
  },
  {
   "cell_type": "code",
   "execution_count": 14,
   "id": "c5304ed6",
   "metadata": {
    "scrolled": true
   },
   "outputs": [],
   "source": [
    "director_exp = movies1['director'].value_counts()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 15,
   "id": "cb410af3",
   "metadata": {},
   "outputs": [],
   "source": [
    "movies1_clean['director_experience'] = movies1_clean.groupby('director')['title'].transform('count')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 16,
   "id": "8c95061f",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>title</th>\n",
       "      <th>runtime</th>\n",
       "      <th>genre</th>\n",
       "      <th>rating</th>\n",
       "      <th>director</th>\n",
       "      <th>votes</th>\n",
       "      <th>gross_earn</th>\n",
       "      <th>12</th>\n",
       "      <th>12A</th>\n",
       "      <th>15</th>\n",
       "      <th>18</th>\n",
       "      <th>A</th>\n",
       "      <th>PG</th>\n",
       "      <th>U</th>\n",
       "      <th>X</th>\n",
       "      <th>director_experience</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>The Shawshank Redemption</td>\n",
       "      <td>142 min</td>\n",
       "      <td>Drama</td>\n",
       "      <td>9.3</td>\n",
       "      <td>Frank Darabont</td>\n",
       "      <td>26,26,905</td>\n",
       "      <td>$28.34M</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>4</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>The Dark Knight</td>\n",
       "      <td>152 min</td>\n",
       "      <td>Action, Crime, Drama</td>\n",
       "      <td>9.0</td>\n",
       "      <td>Christopher Nolan</td>\n",
       "      <td>25,98,173</td>\n",
       "      <td>$534.86M</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>9</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>Inception</td>\n",
       "      <td>148 min</td>\n",
       "      <td>Action, Adventure, Sci-Fi</td>\n",
       "      <td>8.8</td>\n",
       "      <td>Christopher Nolan</td>\n",
       "      <td>23,04,062</td>\n",
       "      <td>$292.58M</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>9</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>Fight Club</td>\n",
       "      <td>139 min</td>\n",
       "      <td>Drama</td>\n",
       "      <td>8.8</td>\n",
       "      <td>David Fincher</td>\n",
       "      <td>20,71,088</td>\n",
       "      <td>$37.03M</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>10</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>Pulp Fiction</td>\n",
       "      <td>154 min</td>\n",
       "      <td>Crime, Drama</td>\n",
       "      <td>8.9</td>\n",
       "      <td>Quentin Tarantino</td>\n",
       "      <td>20,11,013</td>\n",
       "      <td>$107.93M</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>9</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "                      title  runtime                      genre  rating  \\\n",
       "0  The Shawshank Redemption  142 min                      Drama     9.3   \n",
       "1           The Dark Knight  152 min       Action, Crime, Drama     9.0   \n",
       "2                 Inception  148 min  Action, Adventure, Sci-Fi     8.8   \n",
       "3                Fight Club  139 min                      Drama     8.8   \n",
       "4              Pulp Fiction  154 min               Crime, Drama     8.9   \n",
       "\n",
       "            director      votes gross_earn  12  12A  15  18  A  PG  U  X  \\\n",
       "0     Frank Darabont  26,26,905    $28.34M   0    0   1   0  0   0  0  0   \n",
       "1  Christopher Nolan  25,98,173   $534.86M   0    1   0   0  0   0  0  0   \n",
       "2  Christopher Nolan  23,04,062   $292.58M   0    1   0   0  0   0  0  0   \n",
       "3      David Fincher  20,71,088    $37.03M   0    0   0   1  0   0  0  0   \n",
       "4  Quentin Tarantino  20,11,013   $107.93M   0    0   0   1  0   0  0  0   \n",
       "\n",
       "   director_experience  \n",
       "0                    4  \n",
       "1                    9  \n",
       "2                    9  \n",
       "3                   10  \n",
       "4                    9  "
      ]
     },
     "execution_count": 16,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "movies1_clean.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 17,
   "id": "cc00780d",
   "metadata": {},
   "outputs": [],
   "source": [
    "movies1_clean['num_genres'] = movies1_clean['genre'].str.count(',')+1"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 18,
   "id": "5d53762f",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>title</th>\n",
       "      <th>runtime</th>\n",
       "      <th>genre</th>\n",
       "      <th>rating</th>\n",
       "      <th>director</th>\n",
       "      <th>votes</th>\n",
       "      <th>gross_earn</th>\n",
       "      <th>12</th>\n",
       "      <th>12A</th>\n",
       "      <th>15</th>\n",
       "      <th>18</th>\n",
       "      <th>A</th>\n",
       "      <th>PG</th>\n",
       "      <th>U</th>\n",
       "      <th>X</th>\n",
       "      <th>director_experience</th>\n",
       "      <th>num_genres</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>The Shawshank Redemption</td>\n",
       "      <td>142 min</td>\n",
       "      <td>Drama</td>\n",
       "      <td>9.3</td>\n",
       "      <td>Frank Darabont</td>\n",
       "      <td>26,26,905</td>\n",
       "      <td>$28.34M</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>4</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>The Dark Knight</td>\n",
       "      <td>152 min</td>\n",
       "      <td>Action, Crime, Drama</td>\n",
       "      <td>9.0</td>\n",
       "      <td>Christopher Nolan</td>\n",
       "      <td>25,98,173</td>\n",
       "      <td>$534.86M</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>9</td>\n",
       "      <td>3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>Inception</td>\n",
       "      <td>148 min</td>\n",
       "      <td>Action, Adventure, Sci-Fi</td>\n",
       "      <td>8.8</td>\n",
       "      <td>Christopher Nolan</td>\n",
       "      <td>23,04,062</td>\n",
       "      <td>$292.58M</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>9</td>\n",
       "      <td>3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>Fight Club</td>\n",
       "      <td>139 min</td>\n",
       "      <td>Drama</td>\n",
       "      <td>8.8</td>\n",
       "      <td>David Fincher</td>\n",
       "      <td>20,71,088</td>\n",
       "      <td>$37.03M</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>10</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>Pulp Fiction</td>\n",
       "      <td>154 min</td>\n",
       "      <td>Crime, Drama</td>\n",
       "      <td>8.9</td>\n",
       "      <td>Quentin Tarantino</td>\n",
       "      <td>20,11,013</td>\n",
       "      <td>$107.93M</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>9</td>\n",
       "      <td>2</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "                      title  runtime                      genre  rating  \\\n",
       "0  The Shawshank Redemption  142 min                      Drama     9.3   \n",
       "1           The Dark Knight  152 min       Action, Crime, Drama     9.0   \n",
       "2                 Inception  148 min  Action, Adventure, Sci-Fi     8.8   \n",
       "3                Fight Club  139 min                      Drama     8.8   \n",
       "4              Pulp Fiction  154 min               Crime, Drama     8.9   \n",
       "\n",
       "            director      votes gross_earn  12  12A  15  18  A  PG  U  X  \\\n",
       "0     Frank Darabont  26,26,905    $28.34M   0    0   1   0  0   0  0  0   \n",
       "1  Christopher Nolan  25,98,173   $534.86M   0    1   0   0  0   0  0  0   \n",
       "2  Christopher Nolan  23,04,062   $292.58M   0    1   0   0  0   0  0  0   \n",
       "3      David Fincher  20,71,088    $37.03M   0    0   0   1  0   0  0  0   \n",
       "4  Quentin Tarantino  20,11,013   $107.93M   0    0   0   1  0   0  0  0   \n",
       "\n",
       "   director_experience  num_genres  \n",
       "0                    4           1  \n",
       "1                    9           3  \n",
       "2                    9           3  \n",
       "3                   10           1  \n",
       "4                    9           2  "
      ]
     },
     "execution_count": 18,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "movies1_clean.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 19,
   "id": "53d8d353",
   "metadata": {},
   "outputs": [],
   "source": [
    "movies1_clean['main_genre'] = movies1_clean['genre'].str.split(',').str[0]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 20,
   "id": "904ac43e",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>title</th>\n",
       "      <th>runtime</th>\n",
       "      <th>genre</th>\n",
       "      <th>rating</th>\n",
       "      <th>director</th>\n",
       "      <th>votes</th>\n",
       "      <th>gross_earn</th>\n",
       "      <th>12</th>\n",
       "      <th>12A</th>\n",
       "      <th>15</th>\n",
       "      <th>18</th>\n",
       "      <th>A</th>\n",
       "      <th>PG</th>\n",
       "      <th>U</th>\n",
       "      <th>X</th>\n",
       "      <th>director_experience</th>\n",
       "      <th>num_genres</th>\n",
       "      <th>main_genre</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>The Shawshank Redemption</td>\n",
       "      <td>142 min</td>\n",
       "      <td>Drama</td>\n",
       "      <td>9.3</td>\n",
       "      <td>Frank Darabont</td>\n",
       "      <td>26,26,905</td>\n",
       "      <td>$28.34M</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>4</td>\n",
       "      <td>1</td>\n",
       "      <td>Drama</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>The Dark Knight</td>\n",
       "      <td>152 min</td>\n",
       "      <td>Action, Crime, Drama</td>\n",
       "      <td>9.0</td>\n",
       "      <td>Christopher Nolan</td>\n",
       "      <td>25,98,173</td>\n",
       "      <td>$534.86M</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>9</td>\n",
       "      <td>3</td>\n",
       "      <td>Action</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>Inception</td>\n",
       "      <td>148 min</td>\n",
       "      <td>Action, Adventure, Sci-Fi</td>\n",
       "      <td>8.8</td>\n",
       "      <td>Christopher Nolan</td>\n",
       "      <td>23,04,062</td>\n",
       "      <td>$292.58M</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>9</td>\n",
       "      <td>3</td>\n",
       "      <td>Action</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>Fight Club</td>\n",
       "      <td>139 min</td>\n",
       "      <td>Drama</td>\n",
       "      <td>8.8</td>\n",
       "      <td>David Fincher</td>\n",
       "      <td>20,71,088</td>\n",
       "      <td>$37.03M</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>10</td>\n",
       "      <td>1</td>\n",
       "      <td>Drama</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>Pulp Fiction</td>\n",
       "      <td>154 min</td>\n",
       "      <td>Crime, Drama</td>\n",
       "      <td>8.9</td>\n",
       "      <td>Quentin Tarantino</td>\n",
       "      <td>20,11,013</td>\n",
       "      <td>$107.93M</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>9</td>\n",
       "      <td>2</td>\n",
       "      <td>Crime</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "                      title  runtime                      genre  rating  \\\n",
       "0  The Shawshank Redemption  142 min                      Drama     9.3   \n",
       "1           The Dark Knight  152 min       Action, Crime, Drama     9.0   \n",
       "2                 Inception  148 min  Action, Adventure, Sci-Fi     8.8   \n",
       "3                Fight Club  139 min                      Drama     8.8   \n",
       "4              Pulp Fiction  154 min               Crime, Drama     8.9   \n",
       "\n",
       "            director      votes gross_earn  12  12A  15  18  A  PG  U  X  \\\n",
       "0     Frank Darabont  26,26,905    $28.34M   0    0   1   0  0   0  0  0   \n",
       "1  Christopher Nolan  25,98,173   $534.86M   0    1   0   0  0   0  0  0   \n",
       "2  Christopher Nolan  23,04,062   $292.58M   0    1   0   0  0   0  0  0   \n",
       "3      David Fincher  20,71,088    $37.03M   0    0   0   1  0   0  0  0   \n",
       "4  Quentin Tarantino  20,11,013   $107.93M   0    0   0   1  0   0  0  0   \n",
       "\n",
       "   director_experience  num_genres main_genre  \n",
       "0                    4           1      Drama  \n",
       "1                    9           3     Action  \n",
       "2                    9           3     Action  \n",
       "3                   10           1      Drama  \n",
       "4                    9           2      Crime  "
      ]
     },
     "execution_count": 20,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "movies1_clean.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 21,
   "id": "a83bdbdb",
   "metadata": {},
   "outputs": [],
   "source": [
    "bins = [0, 1, 5, 10, movies1_clean['director_experience'].max()]\n",
    "labels = ['1', '2', '3', '4']\n",
    "\n",
    "movies1_clean['director_level'] = pd.cut(movies1_clean['director_experience'], bins=bins, labels=labels)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 22,
   "id": "b0f7847f",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>title</th>\n",
       "      <th>runtime</th>\n",
       "      <th>genre</th>\n",
       "      <th>rating</th>\n",
       "      <th>director</th>\n",
       "      <th>votes</th>\n",
       "      <th>gross_earn</th>\n",
       "      <th>12</th>\n",
       "      <th>12A</th>\n",
       "      <th>15</th>\n",
       "      <th>18</th>\n",
       "      <th>A</th>\n",
       "      <th>PG</th>\n",
       "      <th>U</th>\n",
       "      <th>X</th>\n",
       "      <th>director_experience</th>\n",
       "      <th>num_genres</th>\n",
       "      <th>main_genre</th>\n",
       "      <th>director_level</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>The Shawshank Redemption</td>\n",
       "      <td>142 min</td>\n",
       "      <td>Drama</td>\n",
       "      <td>9.3</td>\n",
       "      <td>Frank Darabont</td>\n",
       "      <td>26,26,905</td>\n",
       "      <td>$28.34M</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>4</td>\n",
       "      <td>1</td>\n",
       "      <td>Drama</td>\n",
       "      <td>2</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>The Dark Knight</td>\n",
       "      <td>152 min</td>\n",
       "      <td>Action, Crime, Drama</td>\n",
       "      <td>9.0</td>\n",
       "      <td>Christopher Nolan</td>\n",
       "      <td>25,98,173</td>\n",
       "      <td>$534.86M</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>9</td>\n",
       "      <td>3</td>\n",
       "      <td>Action</td>\n",
       "      <td>3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>Inception</td>\n",
       "      <td>148 min</td>\n",
       "      <td>Action, Adventure, Sci-Fi</td>\n",
       "      <td>8.8</td>\n",
       "      <td>Christopher Nolan</td>\n",
       "      <td>23,04,062</td>\n",
       "      <td>$292.58M</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>9</td>\n",
       "      <td>3</td>\n",
       "      <td>Action</td>\n",
       "      <td>3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>Fight Club</td>\n",
       "      <td>139 min</td>\n",
       "      <td>Drama</td>\n",
       "      <td>8.8</td>\n",
       "      <td>David Fincher</td>\n",
       "      <td>20,71,088</td>\n",
       "      <td>$37.03M</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>10</td>\n",
       "      <td>1</td>\n",
       "      <td>Drama</td>\n",
       "      <td>3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>Pulp Fiction</td>\n",
       "      <td>154 min</td>\n",
       "      <td>Crime, Drama</td>\n",
       "      <td>8.9</td>\n",
       "      <td>Quentin Tarantino</td>\n",
       "      <td>20,11,013</td>\n",
       "      <td>$107.93M</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>9</td>\n",
       "      <td>2</td>\n",
       "      <td>Crime</td>\n",
       "      <td>3</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "                      title  runtime                      genre  rating  \\\n",
       "0  The Shawshank Redemption  142 min                      Drama     9.3   \n",
       "1           The Dark Knight  152 min       Action, Crime, Drama     9.0   \n",
       "2                 Inception  148 min  Action, Adventure, Sci-Fi     8.8   \n",
       "3                Fight Club  139 min                      Drama     8.8   \n",
       "4              Pulp Fiction  154 min               Crime, Drama     8.9   \n",
       "\n",
       "            director      votes gross_earn  12  12A  15  18  A  PG  U  X  \\\n",
       "0     Frank Darabont  26,26,905    $28.34M   0    0   1   0  0   0  0  0   \n",
       "1  Christopher Nolan  25,98,173   $534.86M   0    1   0   0  0   0  0  0   \n",
       "2  Christopher Nolan  23,04,062   $292.58M   0    1   0   0  0   0  0  0   \n",
       "3      David Fincher  20,71,088    $37.03M   0    0   0   1  0   0  0  0   \n",
       "4  Quentin Tarantino  20,11,013   $107.93M   0    0   0   1  0   0  0  0   \n",
       "\n",
       "   director_experience  num_genres main_genre director_level  \n",
       "0                    4           1      Drama              2  \n",
       "1                    9           3     Action              3  \n",
       "2                    9           3     Action              3  \n",
       "3                   10           1      Drama              3  \n",
       "4                    9           2      Crime              3  "
      ]
     },
     "execution_count": 22,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "movies1_clean.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 23,
   "id": "7d8222c1",
   "metadata": {},
   "outputs": [],
   "source": [
    "movies1_clean['runtime'] = movies1_clean['runtime'].astype(str).str.replace(' min', '').astype(float)\n",
    "movies1_clean['votes'] = movies1_clean['votes'].astype(str).str.replace(',', '').astype(float)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "79339378",
   "metadata": {},
   "outputs": [],
   "source": []
  },
  {
   "cell_type": "code",
   "execution_count": 24,
   "id": "fda30026",
   "metadata": {},
   "outputs": [],
   "source": [
    "movies1_clean = movies1_clean.rename(columns={'gross_earn': 'gross_earn_millions'})\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 25,
   "id": "9ab17139",
   "metadata": {},
   "outputs": [],
   "source": [
    "movies1_clean['gross_earn_millions'] = movies1_clean['gross_earn_millions'].apply(lambda x: float(x.replace('$', '').replace('M', '000000')) if isinstance(x, str) else x)\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 26,
   "id": "9f50dec8",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>title</th>\n",
       "      <th>runtime</th>\n",
       "      <th>genre</th>\n",
       "      <th>rating</th>\n",
       "      <th>director</th>\n",
       "      <th>votes</th>\n",
       "      <th>gross_earn_millions</th>\n",
       "      <th>12</th>\n",
       "      <th>12A</th>\n",
       "      <th>15</th>\n",
       "      <th>18</th>\n",
       "      <th>A</th>\n",
       "      <th>PG</th>\n",
       "      <th>U</th>\n",
       "      <th>X</th>\n",
       "      <th>director_experience</th>\n",
       "      <th>num_genres</th>\n",
       "      <th>main_genre</th>\n",
       "      <th>director_level</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>The Shawshank Redemption</td>\n",
       "      <td>142.0</td>\n",
       "      <td>Drama</td>\n",
       "      <td>9.3</td>\n",
       "      <td>Frank Darabont</td>\n",
       "      <td>2626905.0</td>\n",
       "      <td>28.34</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>4</td>\n",
       "      <td>1</td>\n",
       "      <td>Drama</td>\n",
       "      <td>2</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>The Dark Knight</td>\n",
       "      <td>152.0</td>\n",
       "      <td>Action, Crime, Drama</td>\n",
       "      <td>9.0</td>\n",
       "      <td>Christopher Nolan</td>\n",
       "      <td>2598173.0</td>\n",
       "      <td>534.86</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>9</td>\n",
       "      <td>3</td>\n",
       "      <td>Action</td>\n",
       "      <td>3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>Inception</td>\n",
       "      <td>148.0</td>\n",
       "      <td>Action, Adventure, Sci-Fi</td>\n",
       "      <td>8.8</td>\n",
       "      <td>Christopher Nolan</td>\n",
       "      <td>2304062.0</td>\n",
       "      <td>292.58</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>9</td>\n",
       "      <td>3</td>\n",
       "      <td>Action</td>\n",
       "      <td>3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>Fight Club</td>\n",
       "      <td>139.0</td>\n",
       "      <td>Drama</td>\n",
       "      <td>8.8</td>\n",
       "      <td>David Fincher</td>\n",
       "      <td>2071088.0</td>\n",
       "      <td>37.03</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>10</td>\n",
       "      <td>1</td>\n",
       "      <td>Drama</td>\n",
       "      <td>3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>Pulp Fiction</td>\n",
       "      <td>154.0</td>\n",
       "      <td>Crime, Drama</td>\n",
       "      <td>8.9</td>\n",
       "      <td>Quentin Tarantino</td>\n",
       "      <td>2011013.0</td>\n",
       "      <td>107.93</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>9</td>\n",
       "      <td>2</td>\n",
       "      <td>Crime</td>\n",
       "      <td>3</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "                      title  runtime                      genre  rating  \\\n",
       "0  The Shawshank Redemption    142.0                      Drama     9.3   \n",
       "1           The Dark Knight    152.0       Action, Crime, Drama     9.0   \n",
       "2                 Inception    148.0  Action, Adventure, Sci-Fi     8.8   \n",
       "3                Fight Club    139.0                      Drama     8.8   \n",
       "4              Pulp Fiction    154.0               Crime, Drama     8.9   \n",
       "\n",
       "            director      votes  gross_earn_millions  12  12A  15  18  A  PG  \\\n",
       "0     Frank Darabont  2626905.0                28.34   0    0   1   0  0   0   \n",
       "1  Christopher Nolan  2598173.0               534.86   0    1   0   0  0   0   \n",
       "2  Christopher Nolan  2304062.0               292.58   0    1   0   0  0   0   \n",
       "3      David Fincher  2071088.0                37.03   0    0   0   1  0   0   \n",
       "4  Quentin Tarantino  2011013.0               107.93   0    0   0   1  0   0   \n",
       "\n",
       "   U  X  director_experience  num_genres main_genre director_level  \n",
       "0  0  0                    4           1      Drama              2  \n",
       "1  0  0                    9           3     Action              3  \n",
       "2  0  0                    9           3     Action              3  \n",
       "3  0  0                   10           1      Drama              3  \n",
       "4  0  0                    9           2      Crime              3  "
      ]
     },
     "execution_count": 26,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "movies1_clean.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 27,
   "id": "53e13d27",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "(4864, 19)"
      ]
     },
     "execution_count": 27,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "movies1_clean.shape"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 28,
   "id": "12d1274b",
   "metadata": {},
   "outputs": [],
   "source": [
    "movies1_clean.dropna(subset=['gross_earn_millions'], inplace=True)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 29,
   "id": "b6c6603e",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "      runtime      votes  gross_earn_millions  rating\n",
      "0       142.0  2626905.0                28.34     9.3\n",
      "1       152.0  2598173.0               534.86     9.0\n",
      "2       148.0  2304062.0               292.58     8.8\n",
      "3       139.0  2071088.0                37.03     8.8\n",
      "4       154.0  2011013.0               107.93     8.9\n",
      "...       ...        ...                  ...     ...\n",
      "4992     94.0    20309.0                 6.24     6.2\n",
      "4993    117.0    25669.0                23.00     6.3\n",
      "4995    102.0    25112.0                 9.40     7.3\n",
      "4998     92.0    21536.0                 6.67     7.0\n",
      "4999    120.0    25097.0                 8.20     7.6\n",
      "\n",
      "[4483 rows x 4 columns]\n"
     ]
    }
   ],
   "source": [
    "selected_columns = ['runtime', 'votes', 'gross_earn_millions', 'rating']\n",
    "movies2_clean = movies1_clean[selected_columns]\n",
    "\n",
    "print(movies2_clean)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "09166ec9",
   "metadata": {},
   "outputs": [],
   "source": []
  },
  {
   "cell_type": "code",
   "execution_count": 30,
   "id": "6c79ee66",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "0     28.34\n",
       "1    534.86\n",
       "2    292.58\n",
       "3     37.03\n",
       "4    107.93\n",
       "Name: gross_earn_millions, dtype: float64"
      ]
     },
     "execution_count": 30,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "X = movies2_clean.drop(columns = ['gross_earn_millions'])\n",
    "X.head()\n",
    "y = movies2_clean['gross_earn_millions']\n",
    "y.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 31,
   "id": "610d25e2",
   "metadata": {},
   "outputs": [],
   "source": [
    "from sklearn.model_selection import train_test_split\n",
    "X_train, X_test, y_train, y_test = train_test_split(X,y, test_size = 0.2, random_state = 1984)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "d04e8832",
   "metadata": {},
   "outputs": [],
   "source": []
  },
  {
   "cell_type": "code",
   "execution_count": 32,
   "id": "25e21366",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "LinearRegression()"
      ]
     },
     "execution_count": 32,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "from sklearn.linear_model import LinearRegression\n",
    "OLS = LinearRegression()\n",
    "\n",
    "OLS.fit(X_train, y_train)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 33,
   "id": "18a67939",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Intercept is 83.23899840384124\n",
      "The set of coefficients are [ 2.22167851e-01  2.01805782e-04 -1.32913659e+01]\n",
      "The R-Squared value is 0.3788280608793311\n"
     ]
    }
   ],
   "source": [
    "print('Intercept is ' + str(OLS.intercept_))\n",
    "print('The set of coefficients are ' + str(OLS.coef_))\n",
    "print(\"The R-Squared value is \" + str(OLS.score(X_train, y_train)))"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 34,
   "id": "219bde57",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>PREDICTIONS</th>\n",
       "      <th>ACTUAL VALUES</th>\n",
       "      <th>ERROR</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>4795</th>\n",
       "      <td>56.701975</td>\n",
       "      <td>368.38</td>\n",
       "      <td>311.678025</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4191</th>\n",
       "      <td>22.929110</td>\n",
       "      <td>35.11</td>\n",
       "      <td>12.180890</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>334</th>\n",
       "      <td>95.128456</td>\n",
       "      <td>125.32</td>\n",
       "      <td>30.191544</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4499</th>\n",
       "      <td>35.662334</td>\n",
       "      <td>14.45</td>\n",
       "      <td>-21.212334</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2516</th>\n",
       "      <td>26.580502</td>\n",
       "      <td>17.28</td>\n",
       "      <td>-9.300502</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "      PREDICTIONS  ACTUAL VALUES       ERROR\n",
       "4795    56.701975         368.38  311.678025\n",
       "4191    22.929110          35.11   12.180890\n",
       "334     95.128456         125.32   30.191544\n",
       "4499    35.662334          14.45  -21.212334\n",
       "2516    26.580502          17.28   -9.300502"
      ]
     },
     "execution_count": 34,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "y_pred = OLS.predict(X_test)\n",
    "performance = pd.DataFrame({\"PREDICTIONS\": y_pred, \"ACTUAL VALUES\": y_test})\n",
    "performance['ERROR'] = performance['ACTUAL VALUES'] - performance['PREDICTIONS']\n",
    "performance.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 35,
   "id": "a59ddccb",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>index</th>\n",
       "      <th>PREDICTIONS</th>\n",
       "      <th>ACTUAL VALUES</th>\n",
       "      <th>ERROR</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>0</td>\n",
       "      <td>56.701975</td>\n",
       "      <td>368.38</td>\n",
       "      <td>311.678025</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>1</td>\n",
       "      <td>22.929110</td>\n",
       "      <td>35.11</td>\n",
       "      <td>12.180890</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>2</td>\n",
       "      <td>95.128456</td>\n",
       "      <td>125.32</td>\n",
       "      <td>30.191544</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>3</td>\n",
       "      <td>35.662334</td>\n",
       "      <td>14.45</td>\n",
       "      <td>-21.212334</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>4</td>\n",
       "      <td>26.580502</td>\n",
       "      <td>17.28</td>\n",
       "      <td>-9.300502</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "   index  PREDICTIONS  ACTUAL VALUES       ERROR\n",
       "0      0    56.701975         368.38  311.678025\n",
       "1      1    22.929110          35.11   12.180890\n",
       "2      2    95.128456         125.32   30.191544\n",
       "3      3    35.662334          14.45  -21.212334\n",
       "4      4    26.580502          17.28   -9.300502"
      ]
     },
     "execution_count": 35,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "performance.reset_index(drop = True, inplace = True)\n",
    "performance.reset_index(inplace = True)\n",
    "performance.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 36,
   "id": "f339101a",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "Text(0, 0.5, 'Residuals')"
      ]
     },
     "execution_count": 36,
     "metadata": {},
     "output_type": "execute_result"
    },
    {
     "data": {
      "image/png": "iVBORw0KGgoAAAANSUhEUgAAA14AAAHACAYAAACyK7noAAAAOXRFWHRTb2Z0d2FyZQBNYXRwbG90bGliIHZlcnNpb24zLjUuMiwgaHR0cHM6Ly9tYXRwbG90bGliLm9yZy8qNh9FAAAACXBIWXMAAA9hAAAPYQGoP6dpAAAvCUlEQVR4nO3de5RXdb0//udHkBEREEQZR0YhwZIQT0IRdsFSMCrN1UrpYAblKQ28kJhlroouQtpR8pJ2PdqxC1ZKWccIMqXMNEVJNG8lBgUTXw0BDcFg//7w52c1AjqMs5n5DI/HWnst9t7vz/689nzec3ny3vu9K0VRFAEAAKA0u7R3AQAAAJ2d4AUAAFAywQsAAKBkghcAAEDJBC8AAICSCV4AAAAlE7wAAABKJngBAACUrGt7F1CLNm/enBUrVqRnz56pVCrtXQ4AANBOiqLIunXr0tDQkF122fa4luDVCitWrEhjY2N7lwEAAHQQy5cvz4ABA7a5X/BqhZ49eyZ57ovbq1evdq4GAABoL2vXrk1jY2M1I2yL4NUKz19e2KtXL8ELAAB4yVuQTK4BAABQMsELAACgZIIXAABAyQQvAACAkgleAAAAJRO8AAAASiZ4AQAAlEzwAgAAKJngBQAAUDLBCwAAoGSCFwAAQMkELwAAgJIJXgAAACUTvAAAAErWtb0LANpRpdJ8vSjapw4AgE7OiBcAAEDJBC8AAICSCV4AAAAlE7wAAABKJngBAACUTPACAAAomeAFAABQMsELAACgZIIXAABAyQQvAACAkgleAAAAJRO8AAAASiZ4AQAAlEzwAgAAKJngBQAAUDLBCwAAoGSCFwAAQMkELwAAgJIJXgAAACUTvAAAAEomeAEAAJRM8AIAACiZ4AUAAFAywQsAAKBkghcAAEDJBC8AAICSCV4AAAAl69reBdAGKpXm60XRPnUAAABbZcQLAACgZIIXAABAyQQvAACAktVM8LryyiszfPjw9OrVK7169cro0aPz85//vLq/KIrMmDEjDQ0N6d69e4444ojcf//9zY6xYcOGnH766enXr1969OiRY489Nn/961939KkAAAA7mZoJXgMGDMgXv/jF3HXXXbnrrrvy1re+Ne9617uq4erCCy/MxRdfnMsvvzx33nln6uvrM3bs2Kxbt656jGnTpmXu3LmZM2dObr311jz11FN55zvfmU2bNrXXaQEAADuBSlHU7hR4ffv2zZe+9KV88IMfTENDQ6ZNm5aPf/zjSZ4b3erfv38uuOCCnHLKKVmzZk323nvvXHPNNZkwYUKSZMWKFWlsbMyNN96Yo48+usXvu3bt2vTu3Ttr1qxJr169Sjm37WJWQ1pL3wEAeFlamg1qZsTr323atClz5szJ008/ndGjR2fp0qVpamrKuHHjqm3q6uoyZsyY3HbbbUmSRYsW5dlnn23WpqGhIcOGDau22ZYNGzZk7dq1zRYAAICWqqngtWTJkuyxxx6pq6vLqaeemrlz52bo0KFpampKkvTv379Z+/79+1f3NTU1pVu3bunTp88222zLrFmz0rt37+rS2NjYhmcFAAB0djUVvF75yldm8eLFuf322/ORj3wkkyZNyh//+Mfq/soLLpsqimKLbS/Ukjbnnntu1qxZU12WL1/e+pMAAAB2OjUVvLp165bBgwdn5MiRmTVrVg499NBccsklqa+vT5ItRq5WrVpVHQWrr6/Pxo0bs3r16m222Za6urrqbIrPLwAAAC1VU8HrhYqiyIYNGzJo0KDU19dnwYIF1X0bN27MwoULc/jhhydJRowYkV133bVZm5UrV+a+++6rtgEAAChD1/YuoKU++clPZvz48WlsbMy6desyZ86c3HLLLZk3b14qlUqmTZuWmTNnZsiQIRkyZEhmzpyZ3XffPRMnTkyS9O7dOyeffHKmT5+evfbaK3379s3ZZ5+dQw45JEcddVQ7nx0AANCZ1Uzw+vvf/56TTjopK1euTO/evTN8+PDMmzcvY8eOTZKcc845Wb9+faZMmZLVq1dn1KhRmT9/fnr27Fk9xuzZs9O1a9eccMIJWb9+fY488shcffXV6dKlS3udFgAAsBOo6ed4tRfP8aLT0HcAAF6WTv0cLwAAgFoieAEAAJRM8AIAACiZ4AUAAFAywQsAAKBkghcAAEDJBC8AAICSCV4AAAAlE7wAAABKJngBAACUTPACAAAomeAFAABQMsELAACgZIIXAABAyQQvAACAkgleAAAAJRO8AAAASiZ4AQAAlEzwAgAAKJngBQAAUDLBCwAAoGSCFwAAQMkELwAAgJIJXgAAACUTvAAAAEomeAEAAJRM8AIAACiZ4AUAAFAywQsAAKBkghcAAEDJBC8AAICSCV4AAAAlE7wAAABKJngBAACUTPACAAAomeAFAABQMsELAACgZIIXAABAyQQvAACAkgleAAAAJRO8AAAASiZ4AQAAlEzwAgAAKJngBQAAUDLBCwAAoGSCFwAAQMkELwAAgJIJXgAAACUTvAAAAEomeAEAAJRM8AIAACiZ4AUAAFAywQsAAKBkghcAAEDJBC8AAICSCV4AAAAlE7wAAABKJngBAACUTPACAAAomeAFAABQMsELAACgZDUTvGbNmpXXvva16dmzZ/bZZ58cd9xxeeihh5q1KYoiM2bMSENDQ7p3754jjjgi999/f7M2GzZsyOmnn55+/fqlR48eOfbYY/PXv/51R54KAACwk6mZ4LVw4cJMnTo1t99+exYsWJB//etfGTduXJ5++ulqmwsvvDAXX3xxLr/88tx5552pr6/P2LFjs27dumqbadOmZe7cuZkzZ05uvfXWPPXUU3nnO9+ZTZs2tcdpAQAAO4FKURRFexfRGv/v//2/7LPPPlm4cGHe/OY3pyiKNDQ0ZNq0afn4xz+e5LnRrf79++eCCy7IKaeckjVr1mTvvffONddckwkTJiRJVqxYkcbGxtx44405+uijW/Tea9euTe/evbNmzZr06tWrtHNssUql+XptfqS0B30HAOBlaWk2qJkRrxdas2ZNkqRv375JkqVLl6apqSnjxo2rtqmrq8uYMWNy2223JUkWLVqUZ599tlmbhoaGDBs2rNpmazZs2JC1a9c2WwAAAFqqJoNXURQ566yz8sY3vjHDhg1LkjQ1NSVJ+vfv36xt//79q/uamprSrVu39OnTZ5tttmbWrFnp3bt3dWlsbGzL0wEAADq5mgxep512Wu699958//vf32Jf5QWXThVFscW2F3qpNueee27WrFlTXZYvX966wgEAgJ1SzQWv008/PTfccENuvvnmDBgwoLq9vr4+SbYYuVq1alV1FKy+vj4bN27M6tWrt9lma+rq6tKrV69mCwAAQEvVTPAqiiKnnXZarr/++vzqV7/KoEGDmu0fNGhQ6uvrs2DBguq2jRs3ZuHChTn88MOTJCNGjMiuu+7arM3KlStz3333VdsAAAC0ta7tXUBLTZ06Nd/73vfyk5/8JD179qyObPXu3Tvdu3dPpVLJtGnTMnPmzAwZMiRDhgzJzJkzs/vuu2fixInVtieffHKmT5+evfbaK3379s3ZZ5+dQw45JEcddVR7nh4AANCJ1UzwuvLKK5MkRxxxRLPtV111VSZPnpwkOeecc7J+/fpMmTIlq1evzqhRozJ//vz07Nmz2n727Nnp2rVrTjjhhKxfvz5HHnlkrr766nTp0mVHnQoAALCTqdnneLUnz/Gi09B3AABelk7/HC8AAIBaIXgBAACUTPACAAAomeAFAABQMsELAACgZIIXAABAyQQvAACAkgleAAAAJRO8AAAASiZ4AQAAlEzwAgAAKJngBQAAUDLBCwAAoGSCFwAAQMkELwAAgJIJXgAAACUTvAAAAEomeAEAAJRM8AIAACiZ4AUAAFAywQsAAKBkghcAAEDJBC8AAICSCV4AAAAlE7wAAABKJngBAACUTPACAAAomeAFAABQMsELAACgZIIXAABAydokeG3atCmLFy/O6tWr2+JwAAAAnUqrgte0adPyrW99K8lzoWvMmDE57LDD0tjYmFtuuaUt6wMAAKh5rQpeP/rRj3LooYcmSX76059m6dKlefDBBzNt2rScd955bVogAABArWtV8Hr88cdTX1+fJLnxxhtz/PHH56CDDsrJJ5+cJUuWtGmBAAAAta5Vwat///754x//mE2bNmXevHk56qijkiT//Oc/06VLlzYtEAAAoNZ1bc2LPvCBD+SEE07Ivvvum0qlkrFjxyZJ7rjjjrzqVa9q0wIBAABqXauC14wZMzJs2LAsX748xx9/fOrq6pIkXbp0ySc+8Yk2LRAAAKDWVYqiKNq7iFqzdu3a9O7dO2vWrEmvXr3au5ykUmm+7iOlpfQdAICXpaXZoMUjXpdeemmL3/yMM85ocVsAAIDOrsUjXoMGDWrZASuVPProoy+rqI7OiBedhr4DAPCytPmI19KlS9ukMAAAgJ1Nq6aTBwAAoOVaNathkvz1r3/NDTfckGXLlmXjxo3N9l188cUvuzAAAIDOolXB66abbsqxxx6bQYMG5aGHHsqwYcPy2GOPpSiKHHbYYW1dIwAAQE1r1aWG5557bqZPn5777rsvu+22W6677rosX748Y8aMyfHHH9/WNQIAANS0VgWvBx54IJMmTUqSdO3aNevXr88ee+yRz33uc7ngggvatEAAAIBa16rg1aNHj2zYsCFJ0tDQkD//+c/VfY8//njbVAYAANBJtOoer9e//vX57W9/m6FDh+Yd73hHpk+fniVLluT666/P61//+rauEQAAoKa1KnhdfPHFeeqpp5IkM2bMyFNPPZVrr702gwcPzuzZs9u0QAAAgFpXKYqiaO8iak1Ln069w1Qqzdd9pLSUvgMA8LK0NBt4gDIAAEDJWnWp4S677JLKC/+n/N9s2rSp1QUBAAB0Nq0KXnPnzm22/uyzz+aee+7Jt7/97Xz2s59tk8IAAAA6iza9x+t73/terr322vzkJz9pq0N2SO7xotPQdwAAXpZ2ucdr1KhR+eUvf9mWhwQAAKh5bRa81q9fn8suuywDBgxoq0MCAAB0Cq26x6tPnz7NJtcoiiLr1q3L7rvvnu985zttVhwAAEBn0KrgNXv27GbBa5dddsnee++dUaNGpU+fPm1WHAAAQGfQquA1efLkNi4DAACg82px8Lr33ntbfNDhw4e3qhgAAIDOqMXB6z/+4z9SqVTy/OzzHqAMAADQMi2e1XDp0qV59NFHs3Tp0lx//fUZNGhQrrjiitxzzz255557csUVV+TAAw/MddddV1qxv/71r3PMMcekoaEhlUolP/7xj5vtL4oiM2bMSENDQ7p3754jjjgi999/f7M2GzZsyOmnn55+/fqlR48eOfbYY/PXv/61tJoBAABaHLwOOOCA6jJz5sxceumlOeWUUzJ8+PAMHz48p5xySr785S/n85//fGnFPv300zn00ENz+eWXb3X/hRdemIsvvjiXX3557rzzztTX12fs2LFZt25dtc20adMyd+7czJkzJ7feemueeuqpvPOd7zRKBwAAlKZSPH/t4Hbo3r177r777hx88MHNtj/wwAM57LDDsn79+jYrcFsqlUrmzp2b4447Lslzo10NDQ2ZNm1aPv7xjyd5bnSrf//+ueCCC3LKKadkzZo12XvvvXPNNddkwoQJSZIVK1aksbExN954Y44++ugWvXdLn069w7zwss/t/0jZWek7AAAvS0uzQaseoHzwwQfnC1/4Qp555pnqtg0bNuQLX/jCFmFsR1m6dGmampoybty46ra6urqMGTMmt912W5Jk0aJFefbZZ5u1aWhoyLBhw6pttmbDhg1Zu3ZtswUAAKClWjWd/Fe/+tUcc8wxaWxszKGHHpok+cMf/pBKpZKf/exnbVpgSzU1NSVJ+vfv32x7//7985e//KXaplu3bls8a6x///7V12/NrFmz8tnPfraNKwYAAHYWrQper3vd67J06dJ85zvfyYMPPpiiKDJhwoRMnDgxPXr0aOsat8sLZ1ssiuJFZ2BsSZtzzz03Z511VnV97dq1aWxsfHmFAgAAO41WBa8k2X333fPhD3+4LWt5Werr65M8N6q17777VrevWrWqOgpWX1+fjRs3ZvXq1c1GvVatWpXDDz98m8euq6tLXV1dSZUDAACdXYuD1w033JDx48dn1113zQ033PCibY899tiXXdj2GjRoUOrr67NgwYK85jWvSZJs3LgxCxcuzAUXXJAkGTFiRHbdddcsWLAgJ5xwQpJk5cqVue+++3LhhRfu8JoBAICdQ4uD13HHHZempqbss88+1ZkEt6ZSqZQ2NftTTz2VP/3pT9X1pUuXZvHixenbt2/233//TJs2LTNnzsyQIUMyZMiQzJw5M7vvvnsmTpyYJOndu3dOPvnkTJ8+PXvttVf69u2bs88+O4ccckiOOuqoUmoGAABocfDavHnzVv+9I9111115y1veUl1//r6rSZMm5eqrr84555yT9evXZ8qUKVm9enVGjRqV+fPnp2fPntXXzJ49O127ds0JJ5yQ9evX58gjj8zVV1+dLl267PDzAQAAdg6teo7X1jz55JPZc8892+JQHZ7neNFp6DvQOfheBmg3pT7H64ILLsi1115bXT/++OPTt2/f7LfffvnDH/7QmkMCAAB0Wq0KXl/72teq06kvWLAgv/zlLzNv3ryMHz8+H/vYx9q0QAAAgFrXqunkV65cWQ1eP/vZz3LCCSdk3LhxGThwYEaNGtWmBQIAANS6Vo149enTJ8uXL0+SzJs3rzojYFEUpc1oCAAAUKtaNeL17ne/OxMnTsyQIUPyxBNPZPz48UmSxYsXZ/DgwW1aIAAAQK1rVfCaPXt2Bg4cmOXLl+fCCy/MHnvskeS5SxCnTJnSpgUCAADUujabTn5nYjp5Og19BzoH38sA7abU6eST5Jprrskb3/jGNDQ05C9/+UuS5Mtf/nJ+8pOftPaQAAAAnVKrgteVV16Zs846K+PHj8+TTz5ZnVBjzz33zJe//OW2rA8AAChDpdJ86azv2UG0Knhddtll+cY3vpHzzjsvXbp0qW4fOXJklixZ0mbFAQAAdAatCl5Lly7Na17zmi2219XV5emnn37ZRQEAAHQmrQpegwYNyuLFi7fY/vOf/zwHH3zwy60JAACgU2nVdPIf+9jHMnXq1DzzzDMpiiK///3v8/3vfz8zZ87Mt771rbauEQCAzsAMnOzEWhW8PvCBD+Rf//pXzjnnnPzzn//MxIkTs99+++Wyyy7Lm970prauEQAAoKa1ejr5D33oQ/nLX/6SVatWpampKb///e9zzz33ZPDgwW1ZHwAAQM3bruD15JNP5sQTT8zee++dhoaGXHrppenbt2++8pWvZPDgwbn99tvzP//zP2XVCgAAUJO261LDT37yk/n1r3+dSZMmZd68efnoRz+aefPm5ZlnnsmNN96YMWPGlFUnAABAzdqu4PV///d/ueqqq3LUUUdlypQpGTx4cA466CAPTQYAAHgR23Wp4YoVKzJ06NAkySte8Yrstttu+a//+q9SCgMAAOgstit4bd68Obvuumt1vUuXLunRo0ebFwUAANCZbNelhkVRZPLkyamrq0uSPPPMMzn11FO3CF/XX39921UIAABQ47YreE2aNKnZ+vve9742LQYAAKAz2q7gddVVV5VVBwAA7NwqlebrRdE+dVCK7QpeQAf0wh/SiR/UAAAdzHZNrgEAAMD2E7wAAABKJngBAACUTPACAAAomeAFAABQMrMaAtDxmWIZgBpnxAsAAKBkRryAHcczxwCAnZQRLwAAgJIJXgAAACUTvAAAAEomeAEAAJTM5BoAbckEIgDAVhjxAgAAKJngBQAAUDLBCwAAoGSCFwAAQMkELwAAgJIJXgAAACUznTzbz3TZAACwXYx4AQAAlEzwAgAAKJngBQAAUDLBCwAAoGQm16Bze+FEICYBAQCgHRjxAgAAKJngBQAAUDKXGgJAW3KJMwBbIXgBALzQCwN0IkQDL4tLDQEAAEomeAEAAJTMpYYAANBWXKbKNgheOzM3gAMAnZ2/d+ggXGoIAABQMiNeAB2F/5UFoBa4nLJVjHgBAACUbKcNXldccUUGDRqU3XbbLSNGjMhvfvOb9i4JAKA2VCrNF+Al7ZTB69prr820adNy3nnn5Z577smb3vSmjB8/PsuWLWvv0gAAeKEXBj1hjxpUKYqd74LMUaNG5bDDDsuVV15Z3XbwwQfnuOOOy6xZs17y9WvXrk3v3r2zZs2a9OrVq8xSW6a194W01eu257U72s5wz8zL+Tx29NenlvpOa9XS51FLaulr0x611tLXp1bsDD+vXo5a+tujln7XtXetnfHz2AFamg12uhGvjRs3ZtGiRRk3blyz7ePGjcttt93WTlUBQDswggCww+x0sxo+/vjj2bRpU/r3799se//+/dPU1LTV12zYsCEbNmyorq9du7bUGgEAgM5lpwtez6u84H/2iqLYYtvzZs2alc9+9rM7oqzWae0Q7Y5+XbLjL02opVrb4xxb+1qfx7bV0ufRHpeK7Oiva3ucY3vUuqN/nutz5bxnLd0CUEt/e9TS77paqbWWzrED2ekuNezXr1+6dOmyxejWqlWrthgFe965556bNWvWVJfly5fviFIBAIBOYqcLXt26dcuIESOyYMGCZtsXLFiQww8/fKuvqaurS69evZotAAAALbVTXmp41lln5aSTTsrIkSMzevTofP3rX8+yZcty6qmntndpAABAJ7RTBq8JEybkiSeeyOc+97msXLkyw4YNy4033pgDDjigvUsDoC3V4D0AdAL6HbAVO+VzvF6uDvccr1qyo284fjna++bojvyt6fPoHGppooP20N7P09kR79laO8PkGu2hlibX2BnsDH2nlnTgc2xpNtgpR7yoQR3omwuI70lqh74KdBCCFwBARyAkQqcmeEFH4RcuAECnJXgBnZtACwB0AIIXAHQE/pMAoFMTvKCt+eMJAIAXELwAtkaABgDa0C7tXQAAAEBnZ8QL2H5GgwAAtovgxY7lD3boOHw/Amybn5EdSyf4PAQv2JZO8A0OwE7A7yuoCYIXANDxCRewbb4/aoLJNQAAAEomeAEAAJRM8AIAACiZ4AUAAFAywQsAAKBkZjUEYMeppZm3aqlWADo8wQuoDf4IBgBqmEsNAQAASmbECwDYPkagAbabES8AAICSCV4AAAAlE7wAAABKJngBAACUTPACAAAomeAFAABQMsELAACgZIIXAABAyQQvAACAkgleAAAAJRO8AAAASiZ4AQAAlEzwAgAAKJngBQAAUDLBCwAAoGSCFwAAQMkELwAAgJIJXgAAACUTvAAAAEomeAEAAJRM8AIAACiZ4AUAAFAywQsAAKBkghcAAEDJBC8AAICSCV4AAAAlE7wAAABKJngBAACUTPACAAAomeAFAABQMsELAACgZIIXAABAyQQvAACAkgleAAAAJRO8AAAASiZ4AQAAlEzwAgAAKJngBQAAUDLBCwAAoGSCFwAAQMlqJnidf/75Ofzww7P77rtnzz333GqbZcuW5ZhjjkmPHj3Sr1+/nHHGGdm4cWOzNkuWLMmYMWPSvXv37Lfffvnc5z6Xoih2wBkAAAA7q67tXUBLbdy4Mccff3xGjx6db33rW1vs37RpU97xjndk7733zq233ponnngikyZNSlEUueyyy5Ika9euzdixY/OWt7wld955Zx5++OFMnjw5PXr0yPTp03f0KQEAADuJmglen/3sZ5MkV1999Vb3z58/P3/84x+zfPnyNDQ0JEkuuuiiTJ48Oeeff3569eqV7373u3nmmWdy9dVXp66uLsOGDcvDDz+ciy++OGeddVYqlcqOOh0AAGAnUjOXGr6U3/3udxk2bFg1dCXJ0UcfnQ0bNmTRokXVNmPGjEldXV2zNitWrMhjjz22o0sGAAB2Ep0meDU1NaV///7NtvXp0yfdunVLU1PTNts8v/58m63ZsGFD1q5d22wBAABoqXYNXjNmzEilUnnR5a677mrx8bZ2qWBRFM22v7DN8xNrvNhlhrNmzUrv3r2rS2NjY4trAgAAaNd7vE477bS8973vfdE2AwcObNGx6uvrc8cddzTbtnr16jz77LPVUa36+votRrZWrVqVJFuMhP27c889N2eddVZ1fe3atcIXAADQYu0avPr165d+/fq1ybFGjx6d888/PytXrsy+++6b5LkJN+rq6jJixIhqm09+8pPZuHFjunXrVm3T0NDwogGvrq6u2X1hAAAA26Nm7vFatmxZFi9enGXLlmXTpk1ZvHhxFi9enKeeeipJMm7cuAwdOjQnnXRS7rnnntx00005++yz86EPfSi9evVKkkycODF1dXWZPHly7rvvvsydOzczZ840oyEAAFCqSlEjTw+ePHlyvv3tb2+x/eabb84RRxyR5LlwNmXKlPzqV79K9+7dM3HixPz3f/93s9GqJUuWZOrUqfn973+fPn365NRTT82nP/3p7Qpea9euTe/evbNmzZpqqAMAXsLWftfWxp8hANvU0mxQM8GrIxG8AKAVBC+gE2ppNqiZSw0BAABqleAFAABQMsELAACgZIIXAABAyQQvAACAkgleAAAAJRO8AAAASiZ4AQAAlEzwAgAAKJngBQAAUDLBCwAAoGSCFwAAQMkELwAAgJIJXgAAACUTvAAAAEomeAEAAJRM8AIAACiZ4AUAAFAywQsAAKBkghcAAEDJurZ3AQDATqIo2rsCgHZjxAsAAKBkghcAAEDJBC8AAICSCV4AAAAlE7wAAABKJngBAACUTPACAAAomeAFAABQMsELAACgZIIXAABAyQQvAACAkgleAAAAJRO8AAAASiZ4AQAAlEzwAgAAKJngBQAAULKu7V1ALSqKIkmydu3adq4EAABoT89nguczwrYIXq2wbt26JEljY2M7VwIAAHQE69atS+/evbe5v1K8VDRjC5s3b86KFSvSs2fPVCqV9i4nyXNJu7GxMcuXL0+vXr3auxxqiL5Da+k7tJa+Q2vpO7RG2f2mKIqsW7cuDQ0N2WWXbd/JZcSrFXbZZZcMGDCgvcvYql69evlBRKvoO7SWvkNr6Tu0lr5Da5TZb15spOt5JtcAAAAomeAFAABQMsGrk6irq8tnPvOZ1NXVtXcp1Bh9h9bSd2gtfYfW0ndojY7Sb0yuAQAAUDIjXgAAACUTvAAAAEomeAEAAJRM8AIAACiZ4NUJXHHFFRk0aFB22223jBgxIr/5zW/auyQ6mF//+tc55phj0tDQkEqlkh//+MfN9hdFkRkzZqShoSHdu3fPEUcckfvvv799iqVDmTVrVl772temZ8+e2WeffXLcccfloYceatZG/2FrrrzyygwfPrz6wNLRo0fn5z//eXW/fkNLzJo1K5VKJdOmTatu03fYlhkzZqRSqTRb6uvrq/vbu+8IXjXu2muvzbRp03LeeeflnnvuyZve9KaMHz8+y5Yta+/S6ECefvrpHHroobn88su3uv/CCy/MxRdfnMsvvzx33nln6uvrM3bs2Kxbt24HV0pHs3DhwkydOjW33357FixYkH/9618ZN25cnn766Wob/YetGTBgQL74xS/mrrvuyl133ZW3vvWtede73lX9I0e/4aXceeed+frXv57hw4c3267v8GJe/epXZ+XKldVlyZIl1X3t3ncKatrrXve64tRTT2227VWvelXxiU98op0qoqNLUsydO7e6vnnz5qK+vr744he/WN32zDPPFL179y6++tWvtkOFdGSrVq0qkhQLFy4sikL/Yfv06dOn+OY3v6nf8JLWrVtXDBkypFiwYEExZsyY4swzzyyKws8cXtxnPvOZ4tBDD93qvo7Qd4x41bCNGzdm0aJFGTduXLPt48aNy2233dZOVVFrli5dmqampmb9qK6uLmPGjNGP2MKaNWuSJH379k2i/9AymzZtypw5c/L0009n9OjR+g0vaerUqXnHO96Ro446qtl2fYeX8sgjj6ShoSGDBg3Ke9/73jz66KNJOkbf6bpD3oVSPP7449m0aVP69+/fbHv//v3T1NTUTlVRa57vK1vrR3/5y1/aoyQ6qKIoctZZZ+WNb3xjhg0blkT/4cUtWbIko0ePzjPPPJM99tgjc+fOzdChQ6t/5Og3bM2cOXNy9913584779xin585vJhRo0blf//3f3PQQQfl73//e77whS/k8MMPz/33398h+o7g1QlUKpVm60VRbLENXop+xEs57bTTcu+99+bWW2/dYp/+w9a88pWvzOLFi/Pkk0/muuuuy6RJk7Jw4cLqfv2GF1q+fHnOPPPMzJ8/P7vttts22+k7bM348eOr/z7kkEMyevToHHjggfn2t7+d17/+9Unat++41LCG9evXL126dNlidGvVqlVbpHnYludn+9GPeDGnn356brjhhtx8880ZMGBAdbv+w4vp1q1bBg8enJEjR2bWrFk59NBDc8kll+g3bNOiRYuyatWqjBgxIl27dk3Xrl2zcOHCXHrppenatWu1f+g7tESPHj1yyCGH5JFHHukQP3cErxrWrVu3jBgxIgsWLGi2fcGCBTn88MPbqSpqzaBBg1JfX9+sH23cuDELFy7Uj0hRFDnttNNy/fXX51e/+lUGDRrUbL/+w/YoiiIbNmzQb9imI488MkuWLMnixYury8iRI3PiiSdm8eLFecUrXqHv0GIbNmzIAw88kH333bdD/NxxqWGNO+uss3LSSSdl5MiRGT16dL7+9a9n2bJlOfXUU9u7NDqQp556Kn/605+q60uXLs3ixYvTt2/f7L///pk2bVpmzpyZIUOGZMiQIZk5c2Z23333TJw4sR2rpiOYOnVqvve97+UnP/lJevbsWf2fwt69e6d79+7V5+voP7zQJz/5yYwfPz6NjY1Zt25d5syZk1tuuSXz5s3Tb9imnj17Vu8hfV6PHj2y1157VbfrO2zL2WefnWOOOSb7779/Vq1alS984QtZu3ZtJk2a1DF+7uyQuRMp1Ve+8pXigAMOKLp161Ycdthh1Wme4Xk333xzkWSLZdKkSUVRPDfF6mc+85mivr6+qKurK9785jcXS5Ysad+i6RC21m+SFFdddVW1jf7D1nzwgx+s/m7ae++9iyOPPLKYP39+db9+Q0v9+3TyRaHvsG0TJkwo9t1332LXXXctGhoaine/+93F/fffX93f3n2nUhRFsWMiHgAAwM7JPV4AAAAlE7wAAABKJngBAACUTPACAAAomeAFAABQMsELAACgZIIXAABAyQQvAGrOwIED8+Uvf7m9y2gzt9xySyqVSp588sn2LgWAkgheAHQoy5cvz8knn5yGhoZ069YtBxxwQM4888w88cQT7V1amzjiiCMybdq0ZtsOP/zwrFy5Mr17926fogAoneAFQIfx6KOPZuTIkXn44Yfz/e9/P3/605/y1a9+NTfddFNGjx6df/zjH+1S16ZNm7J58+bSjt+tW7fU19enUqmU9h4AtC/BC4AOY+rUqenWrVvmz5+fMWPGZP/998/48ePzy1/+Mn/7299y3nnnVduuW7cuEydOzB577JGGhoZcdtllzY41Y8aM7L///qmrq0tDQ0POOOOM6r6NGzfmnHPOyX777ZcePXpk1KhRueWWW6r7r7766uy555752c9+lqFDh6auri7f+MY3sttuu21xOeAZZ5yRMWPGJEmeeOKJ/Od//mcGDBiQ3XffPYcccki+//3vV9tOnjw5CxcuzCWXXJJKpZJKpZLHHntsq5caXnfddXn1q1+durq6DBw4MBdddFGz9x04cGBmzpyZD37wg+nZs2f233//fP3rX292jqeddlr23Xff7Lbbbhk4cGBmzZq13Z8JAG1D8AKgQ/jHP/6RX/ziF5kyZUq6d+/ebF99fX1OPPHEXHvttSmKIknypS99KcOHD8/dd9+dc889Nx/96EezYMGCJMmPfvSjzJ49O1/72tfyyCOP5Mc//nEOOeSQ6vE+8IEP5Le//W3mzJmTe++9N8cff3ze9ra35ZFHHqm2+ec//5lZs2blm9/8Zu6///68733vy5577pnrrruu2mbTpk35wQ9+kBNPPDFJ8swzz2TEiBH52c9+lvvuuy8f/vCHc9JJJ+WOO+5IklxyySUZPXp0PvShD2XlypVZuXJlGhsbt/haLFq0KCeccELe+973ZsmSJZkxY0Y+9alP5eqrr27W7qKLLsrIkSNzzz33ZMqUKfnIRz6SBx98MEly6aWX5oYbbsgPfvCDPPTQQ/nOd76TgQMHtvLTAeBlKwCgA7j99tuLJMXcuXO3uv/iiy8ukhR///vfiwMOOKB429ve1mz/hAkTivHjxxdFURQXXXRRcdBBBxUbN27c4jh/+tOfikqlUvztb39rtv3II48szj333KIoiuKqq64qkhSLFy9u1uaMM84o3vrWt1bXf/GLXxTdunUr/vGPf2zzvN7+9rcX06dPr66PGTOmOPPMM5u1ufnmm4skxerVq4uiKIqJEycWY8eObdbmYx/7WDF06NDq+gEHHFC8733vq65v3ry52GeffYorr7yyKIqiOP3004u3vvWtxebNm7dZGwA7jhEvAGpC8f+PdD1/H9To0aOb7R89enQeeOCBJMnxxx+f9evX5xWveEU+9KEPZe7cufnXv/6VJLn77rtTFEUOOuig7LHHHtVl4cKF+fOf/1w9Xrdu3TJ8+PBm73HiiSfmlltuyYoVK5Ik3/3ud/P2t789ffr0SfLcCNj555+f4cOHZ6+99soee+yR+fPnZ9myZdt1rg888EDe8IY3NNv2hje8IY888kg2bdpU3fbv9VUqldTX12fVqlVJnruscfHixXnlK1+ZM844I/Pnz9+uGgBoW4IXAB3C4MGDU6lU8sc//nGr+x988MH06dMn/fr12+Yxng9ljY2Neeihh/KVr3wl3bt3z5QpU/LmN785zz77bDZv3pwuXbpk0aJFWbx4cXV54IEHcskll1SP1b179y0mu3jd616XAw88MHPmzMn69eszd+7cvO9976vuv+iiizJ79uycc845+dWvfpXFixfn6KOPzsaNG7fra1EUxRbv/Xzw/He77rrrFuf//CQghx12WJYuXZrPf/7zWb9+fU444YS85z3v2a46AGg7Xdu7AABIkr322itjx47NFVdckY9+9KPN7vNqamrKd7/73bz//e+vBpLbb7+92etvv/32vOpVr6qud+/ePccee2yOPfbYTJ06Na961auyZMmSvOY1r8mmTZuyatWqvOlNb9ruOidOnJjvfve7GTBgQHbZZZe84x3vqO77zW9+k3e9613VMLZ58+Y88sgjOfjgg6ttunXr1mzUamuGDh2aW2+9tdm22267LQcddFC6dOnS4lp79eqVCRMmZMKECXnPe96Tt73tbfnHP/6Rvn37tvgYALQNI14AdBiXX355NmzYkKOPPjq//vWvs3z58sybNy9jx47Nfvvtl/PPP7/a9re//W0uvPDCPPzww/nKV76SH/7whznzzDOTPDcr4be+9a3cd999efTRR3PNNdeke/fuOeCAA3LQQQflxBNPzPvf//5cf/31Wbp0ae68885ccMEFufHGG1+yxhNPPDF33313zj///LznPe/JbrvtVt03ePDgLFiwILfddlseeOCBnHLKKWlqamr2+oEDB+aOO+7IY489lscff3yr09RPnz49N910Uz7/+c/n4Ycfzre//e1cfvnlOfvss1v8tZw9e3bmzJmTBx98MA8//HB++MMfpr6+PnvuuWeLjwFA2xG8AOgwhgwZkrvuuisHHnhgJkyYkAMPPDAf/vCH85a3vCW/+93vmo3UTJ8+PYsWLcprXvOafP7zn89FF12Uo48+Okmy55575hvf+Ebe8IY3ZPjw4bnpppvy05/+NHvttVeS5Kqrrsr73//+TJ8+Pa985Stz7LHH5o477tjqDINbq/G1r31t7r333upshs/71Kc+lcMOOyxHH310jjjiiNTX1+e4445r1ubss89Oly5dMnTo0Oy9995bvf/rsMMOyw9+8IPMmTMnw4YNy6c//el87nOfy+TJk1v8tdxjjz1ywQUXZOTIkXnta1+bxx57LDfeeGN22cWvfoD2UCm2dtE4AAAAbcZ/ewEAAJRM8AIAACiZ4AUAAFAywQsAAKBkghcAAEDJBC8AAICSCV4AAAAlE7wAAABKJngBAACUTPACAAAomeAFAABQMsELAACgZP8fvLvoTC90VFsAAAAASUVORK5CYII=\n",
      "text/plain": [
       "<Figure size 1000x500 with 1 Axes>"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "fig = plt.figure(figsize = (10,5))\n",
    "plt.bar('index', 'ERROR', data = performance[:50], color = 'red', width = 0.3)\n",
    "plt.xlabel(\"Observations\")\n",
    "plt.ylabel(\"Residuals\")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 37,
   "id": "2719591f",
   "metadata": {
    "scrolled": true
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<table class=\"simpletable\">\n",
       "<caption>OLS Regression Results</caption>\n",
       "<tr>\n",
       "  <th>Dep. Variable:</th>    <td>gross_earn_millions</td> <th>  R-squared:         </th> <td>   0.379</td> \n",
       "</tr>\n",
       "<tr>\n",
       "  <th>Model:</th>                    <td>OLS</td>         <th>  Adj. R-squared:    </th> <td>   0.378</td> \n",
       "</tr>\n",
       "<tr>\n",
       "  <th>Method:</th>              <td>Least Squares</td>    <th>  F-statistic:       </th> <td>   728.2</td> \n",
       "</tr>\n",
       "<tr>\n",
       "  <th>Date:</th>              <td>Sun, 23 Apr 2023</td>   <th>  Prob (F-statistic):</th>  <td>  0.00</td>  \n",
       "</tr>\n",
       "<tr>\n",
       "  <th>Time:</th>                  <td>18:46:58</td>       <th>  Log-Likelihood:    </th> <td> -19305.</td> \n",
       "</tr>\n",
       "<tr>\n",
       "  <th>No. Observations:</th>       <td>  3586</td>        <th>  AIC:               </th> <td>3.862e+04</td>\n",
       "</tr>\n",
       "<tr>\n",
       "  <th>Df Residuals:</th>           <td>  3582</td>        <th>  BIC:               </th> <td>3.864e+04</td>\n",
       "</tr>\n",
       "<tr>\n",
       "  <th>Df Model:</th>               <td>     3</td>        <th>                     </th>     <td> </td>    \n",
       "</tr>\n",
       "<tr>\n",
       "  <th>Covariance Type:</th>       <td>nonrobust</td>      <th>                     </th>     <td> </td>    \n",
       "</tr>\n",
       "</table>\n",
       "<table class=\"simpletable\">\n",
       "<tr>\n",
       "     <td></td>        <th>coef</th>     <th>std err</th>      <th>t</th>      <th>P>|t|</th>  <th>[0.025</th>    <th>0.975]</th>  \n",
       "</tr>\n",
       "<tr>\n",
       "  <th>const</th>   <td>   83.2390</td> <td>    7.092</td> <td>   11.738</td> <td> 0.000</td> <td>   69.335</td> <td>   97.143</td>\n",
       "</tr>\n",
       "<tr>\n",
       "  <th>runtime</th> <td>    0.2222</td> <td>    0.047</td> <td>    4.702</td> <td> 0.000</td> <td>    0.130</td> <td>    0.315</td>\n",
       "</tr>\n",
       "<tr>\n",
       "  <th>votes</th>   <td>    0.0002</td> <td> 4.53e-06</td> <td>   44.505</td> <td> 0.000</td> <td>    0.000</td> <td>    0.000</td>\n",
       "</tr>\n",
       "<tr>\n",
       "  <th>rating</th>  <td>  -13.2914</td> <td>    1.046</td> <td>  -12.704</td> <td> 0.000</td> <td>  -15.343</td> <td>  -11.240</td>\n",
       "</tr>\n",
       "</table>\n",
       "<table class=\"simpletable\">\n",
       "<tr>\n",
       "  <th>Omnibus:</th>       <td>1600.721</td> <th>  Durbin-Watson:     </th> <td>   1.947</td> \n",
       "</tr>\n",
       "<tr>\n",
       "  <th>Prob(Omnibus):</th>  <td> 0.000</td>  <th>  Jarque-Bera (JB):  </th> <td>30427.125</td>\n",
       "</tr>\n",
       "<tr>\n",
       "  <th>Skew:</th>           <td> 1.650</td>  <th>  Prob(JB):          </th> <td>    0.00</td> \n",
       "</tr>\n",
       "<tr>\n",
       "  <th>Kurtosis:</th>       <td>16.883</td>  <th>  Cond. No.          </th> <td>2.12e+06</td> \n",
       "</tr>\n",
       "</table><br/><br/>Notes:<br/>[1] Standard Errors assume that the covariance matrix of the errors is correctly specified.<br/>[2] The condition number is large, 2.12e+06. This might indicate that there are<br/>strong multicollinearity or other numerical problems."
      ],
      "text/plain": [
       "<class 'statsmodels.iolib.summary.Summary'>\n",
       "\"\"\"\n",
       "                             OLS Regression Results                            \n",
       "===============================================================================\n",
       "Dep. Variable:     gross_earn_millions   R-squared:                       0.379\n",
       "Model:                             OLS   Adj. R-squared:                  0.378\n",
       "Method:                  Least Squares   F-statistic:                     728.2\n",
       "Date:                 Sun, 23 Apr 2023   Prob (F-statistic):               0.00\n",
       "Time:                         18:46:58   Log-Likelihood:                -19305.\n",
       "No. Observations:                 3586   AIC:                         3.862e+04\n",
       "Df Residuals:                     3582   BIC:                         3.864e+04\n",
       "Df Model:                            3                                         \n",
       "Covariance Type:             nonrobust                                         \n",
       "==============================================================================\n",
       "                 coef    std err          t      P>|t|      [0.025      0.975]\n",
       "------------------------------------------------------------------------------\n",
       "const         83.2390      7.092     11.738      0.000      69.335      97.143\n",
       "runtime        0.2222      0.047      4.702      0.000       0.130       0.315\n",
       "votes          0.0002   4.53e-06     44.505      0.000       0.000       0.000\n",
       "rating       -13.2914      1.046    -12.704      0.000     -15.343     -11.240\n",
       "==============================================================================\n",
       "Omnibus:                     1600.721   Durbin-Watson:                   1.947\n",
       "Prob(Omnibus):                  0.000   Jarque-Bera (JB):            30427.125\n",
       "Skew:                           1.650   Prob(JB):                         0.00\n",
       "Kurtosis:                      16.883   Cond. No.                     2.12e+06\n",
       "==============================================================================\n",
       "\n",
       "Notes:\n",
       "[1] Standard Errors assume that the covariance matrix of the errors is correctly specified.\n",
       "[2] The condition number is large, 2.12e+06. This might indicate that there are\n",
       "strong multicollinearity or other numerical problems.\n",
       "\"\"\""
      ]
     },
     "execution_count": 37,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "import statsmodels.api as sm\n",
    "X_train = sm.add_constant(X_train)\n",
    "nicerOLS = sm.OLS(y_train, X_train).fit()\n",
    "nicerOLS.summary()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 38,
   "id": "e72f603d",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "      runtime      votes  gross_earn_millions  rating  12  12A  15  18  A  PG  \\\n",
      "0       142.0  2626905.0                28.34     9.3   0    0   1   0  0   0   \n",
      "1       152.0  2598173.0               534.86     9.0   0    1   0   0  0   0   \n",
      "2       148.0  2304062.0               292.58     8.8   0    1   0   0  0   0   \n",
      "3       139.0  2071088.0                37.03     8.8   0    0   0   1  0   0   \n",
      "4       154.0  2011013.0               107.93     8.9   0    0   0   1  0   0   \n",
      "...       ...        ...                  ...     ...  ..  ...  ..  .. ..  ..   \n",
      "4992     94.0    20309.0                 6.24     6.2   1    0   0   0  0   0   \n",
      "4993    117.0    25669.0                23.00     6.3   0    0   0   0  0   0   \n",
      "4995    102.0    25112.0                 9.40     7.3   0    0   0   0  0   0   \n",
      "4998     92.0    21536.0                 6.67     7.0   0    0   0   0  0   1   \n",
      "4999    120.0    25097.0                 8.20     7.6   0    0   0   0  0   0   \n",
      "\n",
      "      U  X director_level  \n",
      "0     0  0              2  \n",
      "1     0  0              3  \n",
      "2     0  0              3  \n",
      "3     0  0              3  \n",
      "4     0  0              3  \n",
      "...  .. ..            ...  \n",
      "4992  0  0              2  \n",
      "4993  0  1              1  \n",
      "4995  1  0              2  \n",
      "4998  0  0              2  \n",
      "4999  0  1              3  \n",
      "\n",
      "[4483 rows x 13 columns]\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>runtime</th>\n",
       "      <th>votes</th>\n",
       "      <th>gross_earn_millions</th>\n",
       "      <th>rating</th>\n",
       "      <th>12</th>\n",
       "      <th>12A</th>\n",
       "      <th>15</th>\n",
       "      <th>18</th>\n",
       "      <th>A</th>\n",
       "      <th>PG</th>\n",
       "      <th>U</th>\n",
       "      <th>X</th>\n",
       "      <th>director_level</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>142.0</td>\n",
       "      <td>2626905.0</td>\n",
       "      <td>28.34</td>\n",
       "      <td>9.3</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>2</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>152.0</td>\n",
       "      <td>2598173.0</td>\n",
       "      <td>534.86</td>\n",
       "      <td>9.0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>148.0</td>\n",
       "      <td>2304062.0</td>\n",
       "      <td>292.58</td>\n",
       "      <td>8.8</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>139.0</td>\n",
       "      <td>2071088.0</td>\n",
       "      <td>37.03</td>\n",
       "      <td>8.8</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>154.0</td>\n",
       "      <td>2011013.0</td>\n",
       "      <td>107.93</td>\n",
       "      <td>8.9</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>3</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "   runtime      votes  gross_earn_millions  rating  12  12A  15  18  A  PG  U  \\\n",
       "0    142.0  2626905.0                28.34     9.3   0    0   1   0  0   0  0   \n",
       "1    152.0  2598173.0               534.86     9.0   0    1   0   0  0   0  0   \n",
       "2    148.0  2304062.0               292.58     8.8   0    1   0   0  0   0  0   \n",
       "3    139.0  2071088.0                37.03     8.8   0    0   0   1  0   0  0   \n",
       "4    154.0  2011013.0               107.93     8.9   0    0   0   1  0   0  0   \n",
       "\n",
       "   X director_level  \n",
       "0  0              2  \n",
       "1  0              3  \n",
       "2  0              3  \n",
       "3  0              3  \n",
       "4  0              3  "
      ]
     },
     "execution_count": 38,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "selected_columns = ['runtime', 'votes', 'gross_earn_millions', 'rating', '12', '12A', '15', '18', 'A', 'PG', 'U', 'X', 'director_level']\n",
    "movies3_clean = movies1_clean[selected_columns]\n",
    "\n",
    "print(movies3_clean)\n",
    "movies3_clean.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 39,
   "id": "062608a6",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>title</th>\n",
       "      <th>runtime</th>\n",
       "      <th>genre</th>\n",
       "      <th>rating</th>\n",
       "      <th>director</th>\n",
       "      <th>votes</th>\n",
       "      <th>gross_earn_millions</th>\n",
       "      <th>12</th>\n",
       "      <th>12A</th>\n",
       "      <th>15</th>\n",
       "      <th>18</th>\n",
       "      <th>A</th>\n",
       "      <th>PG</th>\n",
       "      <th>U</th>\n",
       "      <th>X</th>\n",
       "      <th>director_experience</th>\n",
       "      <th>num_genres</th>\n",
       "      <th>main_genre</th>\n",
       "      <th>director_level</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>The Shawshank Redemption</td>\n",
       "      <td>142.0</td>\n",
       "      <td>Drama</td>\n",
       "      <td>9.3</td>\n",
       "      <td>Frank Darabont</td>\n",
       "      <td>2626905.0</td>\n",
       "      <td>28.34</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>4</td>\n",
       "      <td>1</td>\n",
       "      <td>Drama</td>\n",
       "      <td>2</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>The Dark Knight</td>\n",
       "      <td>152.0</td>\n",
       "      <td>Action, Crime, Drama</td>\n",
       "      <td>9.0</td>\n",
       "      <td>Christopher Nolan</td>\n",
       "      <td>2598173.0</td>\n",
       "      <td>534.86</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>9</td>\n",
       "      <td>3</td>\n",
       "      <td>Action</td>\n",
       "      <td>3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>Inception</td>\n",
       "      <td>148.0</td>\n",
       "      <td>Action, Adventure, Sci-Fi</td>\n",
       "      <td>8.8</td>\n",
       "      <td>Christopher Nolan</td>\n",
       "      <td>2304062.0</td>\n",
       "      <td>292.58</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>9</td>\n",
       "      <td>3</td>\n",
       "      <td>Action</td>\n",
       "      <td>3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>Fight Club</td>\n",
       "      <td>139.0</td>\n",
       "      <td>Drama</td>\n",
       "      <td>8.8</td>\n",
       "      <td>David Fincher</td>\n",
       "      <td>2071088.0</td>\n",
       "      <td>37.03</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>10</td>\n",
       "      <td>1</td>\n",
       "      <td>Drama</td>\n",
       "      <td>3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>Pulp Fiction</td>\n",
       "      <td>154.0</td>\n",
       "      <td>Crime, Drama</td>\n",
       "      <td>8.9</td>\n",
       "      <td>Quentin Tarantino</td>\n",
       "      <td>2011013.0</td>\n",
       "      <td>107.93</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>9</td>\n",
       "      <td>2</td>\n",
       "      <td>Crime</td>\n",
       "      <td>3</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "                      title  runtime                      genre  rating  \\\n",
       "0  The Shawshank Redemption    142.0                      Drama     9.3   \n",
       "1           The Dark Knight    152.0       Action, Crime, Drama     9.0   \n",
       "2                 Inception    148.0  Action, Adventure, Sci-Fi     8.8   \n",
       "3                Fight Club    139.0                      Drama     8.8   \n",
       "4              Pulp Fiction    154.0               Crime, Drama     8.9   \n",
       "\n",
       "            director      votes  gross_earn_millions  12  12A  15  18  A  PG  \\\n",
       "0     Frank Darabont  2626905.0                28.34   0    0   1   0  0   0   \n",
       "1  Christopher Nolan  2598173.0               534.86   0    1   0   0  0   0   \n",
       "2  Christopher Nolan  2304062.0               292.58   0    1   0   0  0   0   \n",
       "3      David Fincher  2071088.0                37.03   0    0   0   1  0   0   \n",
       "4  Quentin Tarantino  2011013.0               107.93   0    0   0   1  0   0   \n",
       "\n",
       "   U  X  director_experience  num_genres main_genre director_level  \n",
       "0  0  0                    4           1      Drama              2  \n",
       "1  0  0                    9           3     Action              3  \n",
       "2  0  0                    9           3     Action              3  \n",
       "3  0  0                   10           1      Drama              3  \n",
       "4  0  0                    9           2      Crime              3  "
      ]
     },
     "execution_count": 39,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "movies1_clean.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 40,
   "id": "8a8728b9",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "['Drama' 'Action' 'Crime' 'Adventure' 'Biography' 'Mystery' 'Animation'\n",
      " 'Comedy' 'Sci-Fi' 'Horror' 'Fantasy' 'Romance' 'Western' 'Family'\n",
      " 'Film-Noir' 'Thriller']\n"
     ]
    }
   ],
   "source": [
    "print(movies1_clean['main_genre'].unique())"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 41,
   "id": "57b4239c",
   "metadata": {},
   "outputs": [],
   "source": [
    "from sklearn.preprocessing import LabelEncoder\n",
    "\n",
    "le = LabelEncoder()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 42,
   "id": "9b1b6bdd",
   "metadata": {},
   "outputs": [],
   "source": [
    "genre_map = {'Action': 1, 'Adventure': 2, 'Animation': 3, 'Biography': 4, 'Comedy': 5, 'Crime': 6, 'Documentary': 7, 'Drama': 8, 'Family': 9, 'Fantasy': 10, 'History': 11, 'Horror': 12, 'Music': 13, 'Musical': 14, 'Mystery': 15, 'Romance': 16, 'Sci-Fi': 17, 'Sport': 18, 'Thriller': 19, 'War': 20, 'Western': 21}\n",
    "movies1_clean['main_genre'] = movies1_clean['main_genre'].map(genre_map)\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 43,
   "id": "60ed2dfa",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>title</th>\n",
       "      <th>runtime</th>\n",
       "      <th>genre</th>\n",
       "      <th>rating</th>\n",
       "      <th>director</th>\n",
       "      <th>votes</th>\n",
       "      <th>gross_earn_millions</th>\n",
       "      <th>12</th>\n",
       "      <th>12A</th>\n",
       "      <th>15</th>\n",
       "      <th>18</th>\n",
       "      <th>A</th>\n",
       "      <th>PG</th>\n",
       "      <th>U</th>\n",
       "      <th>X</th>\n",
       "      <th>director_experience</th>\n",
       "      <th>num_genres</th>\n",
       "      <th>main_genre</th>\n",
       "      <th>director_level</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>The Shawshank Redemption</td>\n",
       "      <td>142.0</td>\n",
       "      <td>Drama</td>\n",
       "      <td>9.3</td>\n",
       "      <td>Frank Darabont</td>\n",
       "      <td>2626905.0</td>\n",
       "      <td>28.34</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>4</td>\n",
       "      <td>1</td>\n",
       "      <td>8.0</td>\n",
       "      <td>2</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>The Dark Knight</td>\n",
       "      <td>152.0</td>\n",
       "      <td>Action, Crime, Drama</td>\n",
       "      <td>9.0</td>\n",
       "      <td>Christopher Nolan</td>\n",
       "      <td>2598173.0</td>\n",
       "      <td>534.86</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>9</td>\n",
       "      <td>3</td>\n",
       "      <td>1.0</td>\n",
       "      <td>3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>Inception</td>\n",
       "      <td>148.0</td>\n",
       "      <td>Action, Adventure, Sci-Fi</td>\n",
       "      <td>8.8</td>\n",
       "      <td>Christopher Nolan</td>\n",
       "      <td>2304062.0</td>\n",
       "      <td>292.58</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>9</td>\n",
       "      <td>3</td>\n",
       "      <td>1.0</td>\n",
       "      <td>3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>Fight Club</td>\n",
       "      <td>139.0</td>\n",
       "      <td>Drama</td>\n",
       "      <td>8.8</td>\n",
       "      <td>David Fincher</td>\n",
       "      <td>2071088.0</td>\n",
       "      <td>37.03</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>10</td>\n",
       "      <td>1</td>\n",
       "      <td>8.0</td>\n",
       "      <td>3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>Pulp Fiction</td>\n",
       "      <td>154.0</td>\n",
       "      <td>Crime, Drama</td>\n",
       "      <td>8.9</td>\n",
       "      <td>Quentin Tarantino</td>\n",
       "      <td>2011013.0</td>\n",
       "      <td>107.93</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>9</td>\n",
       "      <td>2</td>\n",
       "      <td>6.0</td>\n",
       "      <td>3</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "                      title  runtime                      genre  rating  \\\n",
       "0  The Shawshank Redemption    142.0                      Drama     9.3   \n",
       "1           The Dark Knight    152.0       Action, Crime, Drama     9.0   \n",
       "2                 Inception    148.0  Action, Adventure, Sci-Fi     8.8   \n",
       "3                Fight Club    139.0                      Drama     8.8   \n",
       "4              Pulp Fiction    154.0               Crime, Drama     8.9   \n",
       "\n",
       "            director      votes  gross_earn_millions  12  12A  15  18  A  PG  \\\n",
       "0     Frank Darabont  2626905.0                28.34   0    0   1   0  0   0   \n",
       "1  Christopher Nolan  2598173.0               534.86   0    1   0   0  0   0   \n",
       "2  Christopher Nolan  2304062.0               292.58   0    1   0   0  0   0   \n",
       "3      David Fincher  2071088.0                37.03   0    0   0   1  0   0   \n",
       "4  Quentin Tarantino  2011013.0               107.93   0    0   0   1  0   0   \n",
       "\n",
       "   U  X  director_experience  num_genres  main_genre director_level  \n",
       "0  0  0                    4           1         8.0              2  \n",
       "1  0  0                    9           3         1.0              3  \n",
       "2  0  0                    9           3         1.0              3  \n",
       "3  0  0                   10           1         8.0              3  \n",
       "4  0  0                    9           2         6.0              3  "
      ]
     },
     "execution_count": 43,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "movies1_clean.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 44,
   "id": "dafc86fb",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>runtime</th>\n",
       "      <th>votes</th>\n",
       "      <th>gross_earn_millions</th>\n",
       "      <th>rating</th>\n",
       "      <th>12</th>\n",
       "      <th>12A</th>\n",
       "      <th>15</th>\n",
       "      <th>18</th>\n",
       "      <th>A</th>\n",
       "      <th>PG</th>\n",
       "      <th>U</th>\n",
       "      <th>X</th>\n",
       "      <th>director_experience</th>\n",
       "      <th>num_genres</th>\n",
       "      <th>main_genre</th>\n",
       "      <th>director_level</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>142.0</td>\n",
       "      <td>2626905.0</td>\n",
       "      <td>28.34</td>\n",
       "      <td>9.3</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>4</td>\n",
       "      <td>1</td>\n",
       "      <td>8.0</td>\n",
       "      <td>2</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>152.0</td>\n",
       "      <td>2598173.0</td>\n",
       "      <td>534.86</td>\n",
       "      <td>9.0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>9</td>\n",
       "      <td>3</td>\n",
       "      <td>1.0</td>\n",
       "      <td>3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>148.0</td>\n",
       "      <td>2304062.0</td>\n",
       "      <td>292.58</td>\n",
       "      <td>8.8</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>9</td>\n",
       "      <td>3</td>\n",
       "      <td>1.0</td>\n",
       "      <td>3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>139.0</td>\n",
       "      <td>2071088.0</td>\n",
       "      <td>37.03</td>\n",
       "      <td>8.8</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>10</td>\n",
       "      <td>1</td>\n",
       "      <td>8.0</td>\n",
       "      <td>3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>154.0</td>\n",
       "      <td>2011013.0</td>\n",
       "      <td>107.93</td>\n",
       "      <td>8.9</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>9</td>\n",
       "      <td>2</td>\n",
       "      <td>6.0</td>\n",
       "      <td>3</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "   runtime      votes  gross_earn_millions  rating  12  12A  15  18  A  PG  U  \\\n",
       "0    142.0  2626905.0                28.34     9.3   0    0   1   0  0   0  0   \n",
       "1    152.0  2598173.0               534.86     9.0   0    1   0   0  0   0  0   \n",
       "2    148.0  2304062.0               292.58     8.8   0    1   0   0  0   0  0   \n",
       "3    139.0  2071088.0                37.03     8.8   0    0   0   1  0   0  0   \n",
       "4    154.0  2011013.0               107.93     8.9   0    0   0   1  0   0  0   \n",
       "\n",
       "   X  director_experience  num_genres  main_genre director_level  \n",
       "0  0                    4           1         8.0              2  \n",
       "1  0                    9           3         1.0              3  \n",
       "2  0                    9           3         1.0              3  \n",
       "3  0                   10           1         8.0              3  \n",
       "4  0                    9           2         6.0              3  "
      ]
     },
     "execution_count": 44,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "selected_columns = ['runtime', 'votes', 'gross_earn_millions', 'rating', '12', '12A', '15', '18', 'A', 'PG', 'U', 'X', 'director_experience', 'num_genres', 'main_genre', 'director_level']\n",
    "movies_rf = movies1_clean[selected_columns]\n",
    "\n",
    "movies_rf.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 45,
   "id": "6bdd555e",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "runtime                 float64\n",
       "votes                   float64\n",
       "gross_earn_millions     float64\n",
       "rating                  float64\n",
       "12                        uint8\n",
       "12A                       uint8\n",
       "15                        uint8\n",
       "18                        uint8\n",
       "A                         uint8\n",
       "PG                        uint8\n",
       "U                         uint8\n",
       "X                         uint8\n",
       "director_experience       int64\n",
       "num_genres                int64\n",
       "main_genre              float64\n",
       "director_level         category\n",
       "dtype: object"
      ]
     },
     "execution_count": 45,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "movies_rf.dtypes"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 46,
   "id": "141bcbce",
   "metadata": {},
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "/var/folders/qh/81164_ks5gn9fq0dc70qm_fh0000gn/T/ipykernel_59329/1344905347.py:1: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  movies_rf.dropna(inplace=True)\n"
     ]
    }
   ],
   "source": [
    "movies_rf.dropna(inplace=True)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 47,
   "id": "925ccb31",
   "metadata": {},
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "/var/folders/qh/81164_ks5gn9fq0dc70qm_fh0000gn/T/ipykernel_59329/773963775.py:2: FutureWarning: In a future version of pandas all arguments of DataFrame.drop except for the argument 'labels' will be keyword-only.\n",
      "  X_train, X_test, y_train, y_test = train_test_split(movies_rf.drop('gross_earn_millions', 1), movies_rf['gross_earn_millions'], test_size=0.2, random_state=1984)\n"
     ]
    }
   ],
   "source": [
    "from sklearn.model_selection import train_test_split\n",
    "X_train, X_test, y_train, y_test = train_test_split(movies_rf.drop('gross_earn_millions', 1), movies_rf['gross_earn_millions'], test_size=0.2, random_state=1984)\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 48,
   "id": "dbc4e66b",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Training data score:  1.0\n",
      "Test data score:  0.3087403400841886\n"
     ]
    }
   ],
   "source": [
    "from sklearn.tree import DecisionTreeRegressor\n",
    "tree = DecisionTreeRegressor()\n",
    "tree.fit(X_train, y_train)\n",
    "\n",
    "train_data_score = tree.score(X_train, y_train)\n",
    "test_data_score = tree.score(X_test, y_test)\n",
    "\n",
    "print(\"Training data score: \", train_data_score)\n",
    "print(\"Test data score: \", test_data_score)\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 49,
   "id": "44d50e75",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Training data score:  0.753741738393543\n",
      "Test data score:  0.5457649985714974\n"
     ]
    }
   ],
   "source": [
    "tree2 = DecisionTreeRegressor(max_depth = 8)\n",
    "tree2.fit(X_train, y_train)\n",
    "\n",
    "train_data_score = tree2.score(X_train, y_train)\n",
    "test_data_score = tree2.score(X_test, y_test)\n",
    "\n",
    "print(\"Training data score: \", train_data_score)\n",
    "print(\"Test data score: \", test_data_score)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 50,
   "id": "39a80415",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Training data score:  0.9245942669628149\n",
      "Test data score:  0.582407231636417\n"
     ]
    }
   ],
   "source": [
    "from sklearn.ensemble import RandomForestRegressor\n",
    "\n",
    "forest = RandomForestRegressor(n_estimators=10, random_state=1984)\n",
    "forest.fit(X_train, y_train)\n",
    "\n",
    "train_data_score = forest.score(X_train, y_train)\n",
    "test_data_score = forest.score(X_test, y_test)\n",
    "\n",
    "print(\"Training data score: \", train_data_score)\n",
    "print(\"Test data score: \", test_data_score)\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "fcf9517d",
   "metadata": {},
   "outputs": [],
   "source": []
  },
  {
   "cell_type": "code",
   "execution_count": 95,
   "id": "5adcc567",
   "metadata": {
    "scrolled": false
   },
   "outputs": [],
   "source": [
    "from sklearn.ensemble import GradientBoostingRegressor\n",
    "\n",
    "gbtree = GradientBoostingRegressor(learning_rate = 0.3, max_depth = 2, random_state = 1984)\n",
    "gbtree.fit(X_train, y_train)\n",
    "\n",
    "y_pred = gbtree.predict(X_test)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 96,
   "id": "f7cd8dfd",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Training data score:  0.7435101235187883\n",
      "Test data score:  0.6617356154391785\n"
     ]
    }
   ],
   "source": [
    "train_data_score = gbtree.score(X_train, y_train)\n",
    "test_data_score = gbtree.score(X_test, y_test)\n",
    "\n",
    "print(\"Training data score: \", train_data_score)\n",
    "print(\"Test data score: \", test_data_score)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "d3c75b5d",
   "metadata": {},
   "outputs": [],
   "source": []
  },
  {
   "cell_type": "code",
   "execution_count": 97,
   "id": "872b5ad7",
   "metadata": {},
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "/Users/filipe/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:964: FutureWarning: Arrays of bytes/strings is being converted to decimal numbers if dtype='numeric'. This behavior is deprecated in 0.24 and will be removed in 1.1 (renaming of 0.26). Please convert your data to numeric values explicitly instead.\n",
      "  X = check_array(\n",
      "/Users/filipe/opt/anaconda3/lib/python3.9/site-packages/sklearn/base.py:566: FutureWarning: Arrays of bytes/strings is being converted to decimal numbers if dtype='numeric'. This behavior is deprecated in 0.24 and will be removed in 1.1 (renaming of 0.26). Please convert your data to numeric values explicitly instead.\n",
      "  X = check_array(X, **check_params)\n"
     ]
    }
   ],
   "source": [
    "from sklearn.neighbors import KNeighborsRegressor\n",
    "\n",
    "knn = KNeighborsRegressor(n_neighbors=5)\n",
    "knn.fit(X_train, y_train)\n",
    "y_pred = knn.predict(X_test)\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 98,
   "id": "2502b871",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Training data score:  0.5156072750680323\n",
      "Test data score:  0.33429913378824494\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "/Users/filipe/opt/anaconda3/lib/python3.9/site-packages/sklearn/base.py:566: FutureWarning: Arrays of bytes/strings is being converted to decimal numbers if dtype='numeric'. This behavior is deprecated in 0.24 and will be removed in 1.1 (renaming of 0.26). Please convert your data to numeric values explicitly instead.\n",
      "  X = check_array(X, **check_params)\n",
      "/Users/filipe/opt/anaconda3/lib/python3.9/site-packages/sklearn/base.py:566: FutureWarning: Arrays of bytes/strings is being converted to decimal numbers if dtype='numeric'. This behavior is deprecated in 0.24 and will be removed in 1.1 (renaming of 0.26). Please convert your data to numeric values explicitly instead.\n",
      "  X = check_array(X, **check_params)\n"
     ]
    }
   ],
   "source": [
    "train_data_score = knn.score(X_train, y_train)\n",
    "test_data_score = knn.score(X_test, y_test)\n",
    "\n",
    "print(\"Training data score: \", train_data_score)\n",
    "print(\"Test data score: \", test_data_score)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "176cc1b2",
   "metadata": {},
   "outputs": [],
   "source": []
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3 (ipykernel)",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.9.13"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 5
}
